import { Subject } from 'rxjs';
import { map, take } from 'rxjs/operators';
import { DataControl, Sizes } from '../../../core/global-classes';
import { ServiceLocator } from '../../../locator.service';
import { DialogConfigService } from './dialog-config.service';
import { DialogService } from './dialog.service';
export class DialogInitializer {
    constructor(component) {
        this.component = component;
        this.dialogCarrier = new DialogCarrier();
        this.dialogCarrier.setComponent(this.component);
    }
    openDialog$() {
        return this.dialogCarrier.openDialog$().pipe(map(resp => {
            const basicDialogResponse = new DialogResponse();
            const dataControl = new DataControl();
            dataControl.copyValuesFrom(resp, basicDialogResponse);
            return basicDialogResponse;
        }), take(1));
    }
    setButtons(_Buttons) {
        this.dialogCarrier.setButtons(_Buttons);
    }
    setCustomData(_CustomData) {
        this.dialogCarrier.setCustomData(_CustomData);
    }
    setConfig(_DialogConfig) {
        this.dialogCarrier.setConfig(_DialogConfig);
    }
}
export class DialogResponse extends DataControl {
    constructor() {
        super();
        this.payload = null;
        this.success = null;
        this.clickedButtonID = null;
    }
    setPayload(_Payload) {
        this.payload = _Payload;
    }
    setClickedButtonID(_ClickedButtonID) {
        this.clickedButtonID = _ClickedButtonID;
    }
}
export class DialogeventsController {
    constructor(entityUniqueID) {
        this.entityUniqueID = entityUniqueID;
        this._afterClosed = new Subject();
        this._afterLoader = new Subject();
        this._onButtonClick = new Subject();
        this._buttonList = new Subject();
        this.onButtonClick$ = this._onButtonClick.asObservable();
        this.afterClosed$ = this._afterClosed.asObservable();
        this.afterLoader$ = this._afterLoader.asObservable();
        this.buttonList$ = this._buttonList.asObservable();
    }
    close(_Payload = null) {
        this.defaultResponse.setPayload(_Payload);
        this._afterClosed.next(this.defaultResponse);
    }
    onButtonClick(_Button) {
        this.defaultResponse.setClickedButtonID(_Button.ID);
        this._onButtonClick.next(_Button);
    }
    setButtonList(_ButtonList) {
        this._buttonList.next(_ButtonList);
    }
    closeLoader() {
        setTimeout(() => {
            this._afterLoader.next(this.entityUniqueID);
        }, 0);
    }
    setDefaultResponse(_Response) {
        this.defaultResponse = _Response;
    }
}
export class DialogDefaultResponse extends DialogResponse {
    constructor() {
        super();
        this.DialogBelonging = null;
    }
    setBelonging(_DialogBelonging) {
        this.DialogBelonging = _DialogBelonging;
    }
}
export class DialogCarrier {
    constructor() {
        this.dialogBelonging = new DialogBelonging();
    }
    setComponent(_Component) {
        this.component = _Component;
    }
    setButtons(_Buttons) {
        if (_Buttons.length) {
            this.dialogBelonging.buttons = _Buttons;
        }
    }
    setCustomData(_CustomData) {
        this.dialogBelonging.customData = _CustomData;
    }
    setConfig(_DialogConfig) {
        const dataControl = new DataControl();
        dataControl.copyValuesFrom(_DialogConfig, this.dialogBelonging.dialogCoreConfig);
        if (_DialogConfig?.loaderComponent) {
            this.dialogBelonging.dialogCoreConfig.displayLoader = true;
        }
    }
    openDialog$() {
        const service = ServiceLocator.injector.get(DialogService);
        const dialogController = service.open(this.component, this.dialogBelonging);
        return dialogController.afterClosed$;
    }
}
export class DialogCustomStyles {
    constructor() {
        this.buttonSectionCSS = null;
        this.buttonCSS = null;
        this.wrapperCSS = null;
    }
}
export class dialogCoreConfig extends Sizes {
    constructor() {
        super(...arguments);
        this.escapeKeyClose = null;
        this.hideScrollbar = null;
        this.buttonPosition = null;
        this.layoutType = null;
        this.displayLoader = null;
        this.loaderComponent = null;
        this.animationIn = null;
        this.animationOut = null;
        this.customStyles = new DialogCustomStyles();
    }
}
export class DialogSettings {
    constructor() {
        this.buttons = [];
        this.dialogCoreConfig = new dialogCoreConfig();
    }
}
export class DialogBelonging extends DialogSettings {
    constructor() {
        super();
        this.entityUniqueID = 'D' + Math.random().toString(36).substr(2, 9);
        this.customData = null;
        this.eventsController = new DialogeventsController(this.entityUniqueID);
        const dialogConfigurator = ServiceLocator.injector.get(DialogConfigService);
        const baseSettings = new DialogSettings();
        const dataControl = new DataControl();
        dataControl.copyValuesFrom(dialogConfigurator.productionConfig.dialogCoreConfig, baseSettings.dialogCoreConfig);
        this.dialogCoreConfig = baseSettings.dialogCoreConfig;
        this.buttons = dialogConfigurator.productionConfig.buttons.slice();
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xhc3Nlcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL25neC1hd2Vzb21lLXBvcHVwL3R5cGVzL2RpYWxvZy9jb3JlL2NsYXNzZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFjLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUMzQyxPQUFPLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBTzNDLE9BQU8sRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFFbEUsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQzFELE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBQzlELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQWFqRCxNQUFNLE9BQU8saUJBQWlCO0lBRzVCLFlBQW9CLFNBQW9CO1FBQXBCLGNBQVMsR0FBVCxTQUFTLENBQVc7UUFGaEMsa0JBQWEsR0FBa0IsSUFBSSxhQUFhLEVBQUUsQ0FBQztRQUd6RCxJQUFJLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDbEQsQ0FBQztJQUdELFdBQVc7UUFDVCxPQUFPLElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxFQUFFLENBQUMsSUFBSSxDQUMxQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDVCxNQUFNLG1CQUFtQixHQUFHLElBQUksY0FBYyxFQUFFLENBQUM7WUFDakQsTUFBTSxXQUFXLEdBQUcsSUFBSSxXQUFXLEVBQUUsQ0FBQztZQUN0QyxXQUFXLENBQUMsY0FBYyxDQUFDLElBQUksRUFBRSxtQkFBbUIsQ0FBQyxDQUFDO1lBQ3RELE9BQU8sbUJBQW1CLENBQUM7UUFDN0IsQ0FBQyxDQUFDLEVBQ0YsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUNS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QztRQUNoSCxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsWUFBWSxDQUFDLGdCQUFnQixDQUFDO1FBQ3RELElBQUksQ0FBQyxPQUFPLEdBQUcsa0JBQWtCLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQ3JFLENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFR5cGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE9ic2VydmFibGUsIFN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IG1hcCwgdGFrZSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7XG4gIEFwcGVhcmFuY2VBbmltYXRpb24sXG4gIERpYWxvZ0xheW91dERpc3BsYXksXG4gIERpc2FwcGVhcmFuY2VBbmltYXRpb24sXG4gIFZlcnRpY2FsUG9zaXRpb25cbn0gZnJvbSAnLi4vLi4vLi4vY29yZS9lbnVtcyc7XG5pbXBvcnQgeyBEYXRhQ29udHJvbCwgU2l6ZXMgfSBmcm9tICcuLi8uLi8uLi9jb3JlL2dsb2JhbC1jbGFzc2VzJztcbmltcG9ydCB7IElCdXR0b24gfSBmcm9tICcuLi8uLi8uLi9jb3JlL2dsb2JhbC1pbnRlcmZhY2VzJztcbmltcG9ydCB7IFNlcnZpY2VMb2NhdG9yIH0gZnJvbSAnLi4vLi4vLi4vbG9jYXRvci5zZXJ2aWNlJztcbmltcG9ydCB7IERpYWxvZ0NvbmZpZ1NlcnZpY2UgfSBmcm9tICcuL2RpYWxvZy1jb25maWcuc2VydmljZSc7XG5pbXBvcnQgeyBEaWFsb2dTZXJ2aWNlIH0gZnJvbSAnLi9kaWFsb2cuc2VydmljZSc7XG5pbXBvcnQge1xuICBJRGlhbG9nQmVsb25naW5nLFxuICBJRGlhbG9nQ29yZUNvbmZpZyxcbiAgSURpYWxvZ0N1c3RvbVN0eWxlcyxcbiAgSURpYWxvZ2V2ZW50c0NvbnRyb2xsZXIsXG4gIElEaWFsb2dQdWJsaWNSZXNwb25zZSxcbiAgSURpYWxvZ1Jlc3BvbnNlLFxuICBJUHJpdmF0ZVJlc3BvbnNlTWVyZ2VkXG59IGZyb20gJy4vaW50ZXJmYWNlcyc7XG5cbi8vIHJlZ2lvbiAqKiogUHVibGljICoqKlxuXG5leHBvcnQgY2xhc3MgRGlhbG9nSW5pdGlhbGl6ZXIge1xuICBwcml2YXRlIGRpYWxvZ0NhcnJpZXI6IERpYWxvZ0NhcnJpZXIgPSBuZXcgRGlhbG9nQ2FycmllcigpO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgY29tcG9uZW50OiBUeXBlPGFueT4pIHtcbiAgICB0aGlzLmRpYWxvZ0NhcnJpZXIuc2V0Q29tcG9uZW50KHRoaXMuY29tcG9uZW50KTtcbiAgfVxuXG4gIC8qKiBHZW5lcmljIG1ldGhvZCBhY2NlcHQgZXhwZWN0ZWQgcGF5bG9hZCBmcm9tIGR5bmFtaWMgY2hpbGQgY29tcG9uZW50LiovXG4gIG9wZW5EaWFsb2ckPFJlc3BvbnNlUGF5bG9hZCA9IGFueT4oKTogT2JzZXJ2YWJsZTxJRGlhbG9nUHVibGljUmVzcG9uc2U8UmVzcG9uc2VQYXlsb2FkPj4ge1xuICAgIHJldHVybiB0aGlzLmRpYWxvZ0NhcnJpZXIub3BlbkRpYWxvZyQoKS5waXBlKFxuICAgICAgbWFwKHJlc3AgPT4ge1xuICAgICAgICBjb25zdCBiYXNpY0RpYWxvZ1Jlc3BvbnNlID0gbmV3IERpYWxvZ1Jlc3BvbnNlKCk7XG4gICAgICAgIGNvbnN0IGRhdGFDb250cm9sID0gbmV3IERhdGFDb250cm9sKCk7XG4gICAgICAgIGRhdGFDb250cm9sLmNvcHlWYWx1ZXNGcm9tKHJlc3AsIGJhc2ljRGlhbG9nUmVzcG9uc2UpO1xuICAgICAgICByZXR1cm4gYmFzaWNEaWFsb2dSZXNwb25zZTtcbiAgICAgIH0pLFxuICAgICAgdGFrZSgxKVxuICAgICk7XG4gIH1cblxuICAvKiogSXQgYWNjZXB0cyBsaXN0IG9mIGN1c3RvbSBidXR0b25zICovXG4gIHNldEJ1dHRvbnMoX0J1dHRvbnM6IElCdXR0b25bXSk6IHZvaWQge1xuICAgIHRoaXMuZGlhbG9nQ2Fycmllci5zZXRCdXR0b25zKF9CdXR0b25zKTtcbiAgfVxuXG4gIHNldEN1c3RvbURhdGEoX0N1c3RvbURhdGE6IGFueSk6IHZvaWQge1xuICAgIHRoaXMuZGlhbG9nQ2Fycmllci5zZXRDdXN0b21EYXRhKF9DdXN0b21EYXRhKTtcbiAgfVxuXG4gIHNldENvbmZpZyhfRGlhbG9nQ29uZmlnOiBJRGlhbG9nQ29yZUNvbmZpZyk6IHZvaWQge1xuICAgIHRoaXMuZGlhbG9nQ2Fycmllci5zZXRDb25maWcoX0RpYWxvZ0NvbmZpZyk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIERpYWxvZ1Jlc3BvbnNlIGV4dGVuZHMgRGF0YUNvbnRyb2wgaW1wbGVtZW50cyBJRGlhbG9nUmVzcG9uc2UsIElEaWFsb2dQdWJsaWNSZXNwb25zZTxhbnk+IHtcbiAgLy8gcHJpdmF0ZSBSZXNwb25zZTogRGlhbG9nUHJlcGFyZVJlc3BvbnNlICAgICAgICAgICAgPSBuZXcgRGlhbG9nUHJlcGFyZVJlc3BvbnNlKCk7XG5cbiAgcGF5bG9hZDogYW55ID0gbnVsbDtcbiAgc3VjY2VzczogYm9vbGVhbiA9IG51bGw7XG4gIGNsaWNrZWRCdXR0b25JRDogc3RyaW5nID0gbnVsbDtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIHNldFBheWxvYWQoX1BheWxvYWQ6IGFueSk6IHZvaWQge1xuICAgIHRoaXMucGF5bG9hZCA9IF9QYXlsb2FkO1xuICB9XG5cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIHNldENsaWNrZWRCdXR0b25JRChfQ2xpY2tlZEJ1dHRvbklEKTogdm9pZCB7XG4gICAgdGhpcy5jbGlja2VkQnV0dG9uSUQgPSBfQ2xpY2tlZEJ1dHRvbklEO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBEaWFsb2dldmVudHNDb250cm9sbGVyIGltcGxlbWVudHMgSURpYWxvZ2V2ZW50c0NvbnRyb2xsZXIge1xuICBwcml2YXRlIHJlYWRvbmx5IF9hZnRlckNsb3NlZDogU3ViamVjdDxJUHJpdmF0ZVJlc3BvbnNlTWVyZ2VkPiA9IG5ldyBTdWJqZWN0PElQcml2YXRlUmVzcG9uc2VNZXJnZWQ+KCk7XG4gIHByaXZhdGUgcmVhZG9ubHkgX2FmdGVyTG9hZGVyOiBhbnkgPSBuZXcgU3ViamVjdDxzdHJpbmc+KCk7XG4gIHByaXZhdGUgcmVhZG9ubHkgX29uQnV0dG9uQ2xpY2s6IFN1YmplY3Q8SUJ1dHRvbj4gPSBuZXcgU3ViamVjdDxJQnV0dG9uPigpO1xuICBwcml2YXRlIHJlYWRvbmx5IF9idXR0b25MaXN0OiBTdWJqZWN0PElCdXR0b25bXT4gPSBuZXcgU3ViamVjdDxJQnV0dG9uW10+KCk7XG4gIGRlZmF1bHRSZXNwb25zZTogSVByaXZhdGVSZXNwb25zZU1lcmdlZDtcbiAgb25CdXR0b25DbGljayQ6IE9ic2VydmFibGU8SUJ1dHRvbj4gPSB0aGlzLl9vbkJ1dHRvbkNsaWNrLmFzT2JzZXJ2YWJsZSgpO1xuICBhZnRlckNsb3NlZCQ6IE9ic2VydmFibGU8SVByaXZhdGVSZXNwb25zZU1lcmdlZD4gPSB0aGlzLl9hZnRlckNsb3NlZC5hc09ic2VydmFibGUoKTtcbiAgYWZ0ZXJMb2FkZXIkOiBPYnNlcnZhYmxlPHN0cmluZz4gPSB0aGlzLl9hZnRlckxvYWRlci5hc09ic2VydmFibGUoKTtcbiAgYnV0dG9uTGlzdCQ6IE9ic2VydmFibGU8SUJ1dHRvbltdPiA9IHRoaXMuX2J1dHRvbkxpc3QuYXNPYnNlcnZhYmxlKCk7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBlbnRpdHlVbmlxdWVJRDogc3RyaW5nKSB7fVxuXG4gIGNsb3NlKF9QYXlsb2FkOiBhbnkgPSBudWxsKTogdm9pZCB7XG4gICAgdGhpcy5kZWZhdWx0UmVzcG9uc2Uuc2V0UGF5bG9hZChfUGF5bG9hZCk7XG4gICAgdGhpcy5fYWZ0ZXJDbG9zZWQubmV4dCh0aGlzLmRlZmF1bHRSZXNwb25zZSk7XG4gIH1cblxuICBvbkJ1dHRvbkNsaWNrKF9CdXR0b246IElCdXR0b24pOiB2b2lkIHtcbiAgICB0aGlzLmRlZmF1bHRSZXNwb25zZS5zZXRDbGlja2VkQnV0dG9uSUQoX0J1dHRvbi5JRCk7XG4gICAgdGhpcy5fb25CdXR0b25DbGljay5uZXh0KF9CdXR0b24pO1xuICB9XG5cbiAgc2V0QnV0dG9uTGlzdChfQnV0dG9uTGlzdDogSUJ1dHRvbltdKTogdm9pZCB7XG4gICAgdGhpcy5fYnV0dG9uTGlzdC5uZXh0KF9CdXR0b25MaXN0KTtcbiAgfVxuXG4gIGNsb3NlTG9hZGVyKCk6IHZvaWQge1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5fYWZ0ZXJMb2FkZXIubmV4dCh0aGlzLmVudGl0eVVuaXF1ZUlEKTtcbiAgICB9LCAwKTtcbiAgfVxuXG4gIHNldERlZmF1bHRSZXNwb25zZShfUmVzcG9uc2U6IElQcml2YXRlUmVzcG9uc2VNZXJnZWQpOiB2b2lkIHtcbiAgICB0aGlzLmRlZmF1bHRSZXNwb25zZSA9IF9SZXNwb25zZTtcbiAgfVxufVxuXG4vLyBlbmRyZWdpb25cblxuZXhwb3J0IGNsYXNzIERpYWxvZ0RlZmF1bHRSZXNwb25zZSBleHRlbmRzIERpYWxvZ1Jlc3BvbnNlIGltcGxlbWVudHMgSVByaXZhdGVSZXNwb25zZU1lcmdlZCB7XG4gIERpYWxvZ0JlbG9uZ2luZzogSURpYWxvZ0JlbG9uZ2luZyA9IG51bGw7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIHNldEJlbG9uZ2luZyhfRGlhbG9nQmVsb25naW5nKTogdm9pZCB7XG4gICAgdGhpcy5EaWFsb2dCZWxvbmdpbmcgPSBfRGlhbG9nQmVsb25naW5nO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBEaWFsb2dDYXJyaWVyIHtcbiAgcHJpdmF0ZSBjb21wb25lbnQ6IFR5cGU8YW55PjtcbiAgZGlhbG9nQmVsb25naW5nOiBEaWFsb2dCZWxvbmdpbmcgPSBuZXcgRGlhbG9nQmVsb25naW5nKCk7XG5cbiAgY29uc3RydWN0b3IoKSB7fVxuXG4gIHNldENvbXBvbmVudChfQ29tcG9uZW50OiBUeXBlPGFueT4pOiB2b2lkIHtcbiAgICB0aGlzLmNvbXBvbmVudCA9IF9Db21wb25lbnQ7XG4gIH1cblxuICBzZXRCdXR0b25zKF9CdXR0b25zOiBJQnV0dG9uW10pOiB2b2lkIHtcbiAgICBpZiAoX0J1dHRvbnMubGVuZ3RoKSB7XG4gICAgICB0aGlzLmRpYWxvZ0JlbG9uZ2luZy5idXR0b25zID0gX0J1dHRvbnM7XG4gICAgfVxuICB9XG5cbiAgc2V0Q3VzdG9tRGF0YShfQ3VzdG9tRGF0YTogYW55KTogdm9pZCB7XG4gICAgdGhpcy5kaWFsb2dCZWxvbmdpbmcuY3VzdG9tRGF0YSA9IF9DdXN0b21EYXRhO1xuICB9XG5cbiAgc2V0Q29uZmlnKF9EaWFsb2dDb25maWc6IElEaWFsb2dDb3JlQ29uZmlnKTogdm9pZCB7XG4gICAgLy8gcmVnaW9uICoqKiBsb2NhbCBVc2VyQ29uZmlnIChkZWZpbmVkIG9uIHBsYWNlIHdoZXJlIGRpYWxvZyBpcyBjYWxsZWQpICoqKlxuICAgIGNvbnN0IGRhdGFDb250cm9sID0gbmV3IERhdGFDb250cm9sKCk7XG4gICAgZGF0YUNvbnRyb2wuY29weVZhbHVlc0Zyb20oX0RpYWxvZ0NvbmZpZywgdGhpcy5kaWFsb2dCZWxvbmdpbmcuZGlhbG9nQ29yZUNvbmZpZyk7XG4gICAgaWYgKF9EaWFsb2dDb25maWc/LmxvYWRlckNvbXBvbmVudCkge1xuICAgICAgdGhpcy5kaWFsb2dCZWxvbmdpbmcuZGlhbG9nQ29yZUNvbmZpZy5kaXNwbGF5TG9hZGVyID0gdHJ1ZTtcbiAgICB9XG4gICAgLy8gZW5kcmVnaW9uXG4gIH1cblxuICBvcGVuRGlhbG9nJCgpOiBPYnNlcnZhYmxlPElQcml2YXRlUmVzcG9uc2VNZXJnZWQ+IHtcbiAgICBjb25zdCBzZXJ2aWNlOiBEaWFsb2dTZXJ2aWNlID0gU2VydmljZUxvY2F0b3IuaW5qZWN0b3IuZ2V0KERpYWxvZ1NlcnZpY2UpO1xuICAgIGNvbnN0IGRpYWxvZ0NvbnRyb2xsZXIgPSBzZXJ2aWNlLm9wZW4odGhpcy5jb21wb25lbnQsIHRoaXMuZGlhbG9nQmVsb25naW5nKTtcbiAgICByZXR1cm4gZGlhbG9nQ29udHJvbGxlci5hZnRlckNsb3NlZCQ7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIERpYWxvZ0N1c3RvbVN0eWxlcyBpbXBsZW1lbnRzIElEaWFsb2dDdXN0b21TdHlsZXMge1xuICBidXR0b25TZWN0aW9uQ1NTOiBzdHJpbmcgPSBudWxsO1xuICBidXR0b25DU1M6IHN0cmluZyA9IG51bGw7XG4gIHdyYXBwZXJDU1M6IHN0cmluZyA9IG51bGw7XG59XG5cbmV4cG9ydCBjbGFzcyBkaWFsb2dDb3JlQ29uZmlnIGV4dGVuZHMgU2l6ZXMgaW1wbGVtZW50cyBJRGlhbG9nQ29yZUNvbmZpZyB7XG4gIGVzY2FwZUtleUNsb3NlOiBib29sZWFuID0gbnVsbDtcbiAgaGlkZVNjcm9sbGJhcjogYm9vbGVhbiA9IG51bGw7XG4gIGJ1dHRvblBvc2l0aW9uOiBWZXJ0aWNhbFBvc2l0aW9uID0gbnVsbDtcbiAgbGF5b3V0VHlwZTogRGlhbG9nTGF5b3V0RGlzcGxheSA9IG51bGw7XG4gIGRpc3BsYXlMb2FkZXI6IGJvb2xlYW4gPSBudWxsO1xuICBsb2FkZXJDb21wb25lbnQ6IFR5cGU8YW55PiA9IG51bGw7XG4gIGFuaW1hdGlvbkluOiBBcHBlYXJhbmNlQW5pbWF0aW9uID0gbnVsbDtcbiAgYW5pbWF0aW9uT3V0OiBEaXNhcHBlYXJhbmNlQW5pbWF0aW9uID0gbnVsbDtcbiAgY3VzdG9tU3R5bGVzOiBJRGlhbG9nQ3VzdG9tU3R5bGVzID0gbmV3IERpYWxvZ0N1c3RvbVN0eWxlcygpO1xufVxuXG5leHBvcnQgY2xhc3MgRGlhbG9nU2V0dGluZ3Mge1xuICBidXR0b25zOiBJQnV0dG9uW10gPSBbXTtcbiAgZGlhbG9nQ29yZUNvbmZpZzogSURpYWxvZ0NvcmVDb25maWcgPSBuZXcgZGlhbG9nQ29yZUNvbmZpZygpO1xufVxuXG5leHBvcnQgY2xhc3MgRGlhbG9nQmVsb25naW5nPEN1c3RvbURhdGEgPSBhbnk+IGV4dGVuZHMgRGlhbG9nU2V0dGluZ3MgaW1wbGVtZW50cyBJRGlhbG9nQmVsb25naW5nIHtcbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBlbnRpdHlVbmlxdWVJRDogc3RyaW5nID0gJ0QnICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpO1xuXG4gIGN1c3RvbURhdGE6IEN1c3RvbURhdGEgPSBudWxsO1xuICBldmVudHNDb250cm9sbGVyOiBJRGlhbG9nZXZlbnRzQ29udHJvbGxlcjtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuZXZlbnRzQ29udHJvbGxlciA9IG5ldyBEaWFsb2dldmVudHNDb250cm9sbGVyKHRoaXMuZW50aXR5VW5pcXVlSUQpO1xuICAgIGNvbnN0IGRpYWxvZ0NvbmZpZ3VyYXRvcjogRGlhbG9nQ29uZmlnU2VydmljZSA9IFNlcnZpY2VMb2NhdG9yLmluamVjdG9yLmdldChEaWFsb2dDb25maWdTZXJ2aWNlKTtcbiAgICBjb25zdCBiYXNlU2V0dGluZ3MgPSBuZXcgRGlhbG9nU2V0dGluZ3MoKTtcbiAgICBjb25zdCBkYXRhQ29udHJvbCA9IG5ldyBEYXRhQ29udHJvbCgpO1xuICAgIGRhdGFDb250cm9sLmNvcHlWYWx1ZXNGcm9tKGRpYWxvZ0NvbmZpZ3VyYXRvci5wcm9kdWN0aW9uQ29uZmlnLmRpYWxvZ0NvcmVDb25maWcsIGJhc2VTZXR0aW5ncy5kaWFsb2dDb3JlQ29uZmlnKTtcbiAgICB0aGlzLmRpYWxvZ0NvcmVDb25maWcgPSBiYXNlU2V0dGluZ3MuZGlhbG9nQ29yZUNvbmZpZztcbiAgICB0aGlzLmJ1dHRvbnMgPSBkaWFsb2dDb25maWd1cmF0b3IucHJvZHVjdGlvbkNvbmZpZy5idXR0b25zLnNsaWNlKCk7XG4gIH1cbn1cbiJdfQ==