import { ButtonLayoutDisplay } from './enums';
export class Sizes {
    constructor() {
        this.width = null;
        this.minWidth = null;
        this.maxWidth = null;
        this.height = null;
        this.minHeight = null;
        this.maxHeight = null;
        this.fullScreen = null;
    }
}
export class dispatch {
    constructor() {
        this.title = null;
        this.message = null;
    }
}
export class ButtonMaker {
    constructor(label, ID, layoutType = ButtonLayoutDisplay.PRIMARY) {
        this.label = label;
        this.ID = ID;
        this.layoutType = layoutType;
    }
}
export class GlobalUserConfig {
    constructor(_GlobalUserConfig) {
        this.colorList = new ColorTypes();
        if (_GlobalUserConfig) {
            const dataControl = new DataControl();
            dataControl.copyValuesFrom(_GlobalUserConfig, this);
            const colorList = new ColorTypes();
            this.colorList = dataControl.copyValuesFrom(this.colorList, colorList);
        }
    }
}
export class ColorTypes {
    constructor() {
        this.primary = null;
        this.secondary = null;
        this.success = null;
        this.info = null;
        this.warning = null;
        this.danger = null;
        this.light = null;
        this.dark = null;
        this.customOne = null;
        this.customTwo = null;
        this.customThree = null;
        this.customFour = null;
        this.customFive = null;
    }
}
export class GlobalConfig {
    constructor() {
        this.displayColor = new DisplayColor();
    }
}
export class DisplayColor {
    constructor() {
        this.primary = null;
        this.secondary = null;
        this.success = null;
        this.info = null;
        this.warning = null;
        this.danger = null;
        this.light = null;
        this.dark = null;
        this.customOne = null;
        this.customTwo = null;
        this.customThree = null;
        this.customFour = null;
        this.customFive = null;
    }
}
export class ColorProvider {
    constructor(_Color) {
        this.Base = null;
        this.Brighten = null;
        this.BrightenForShade = null;
        this.Darken = null;
        this.DarkenForShade = null;
        this.ContrastColor = null;
        this.TransparentDarkenVariance = null;
        this.BrightShade = null;
        this.BrightWarmly = null;
        this.IsBaseBright = null;
        if ((this.Base = this.isColor(_Color))) {
            this.Brighten = this.brightness(this.Base, 'brighten', 25);
            this.BrightenForShade = this.brightness(this.Base, 'brighten', 10);
            this.Darken = this.brightness(this.Base, 'darken', 20);
            this.DarkenForShade = this.brightness(this.Base, 'darken', 10);
            const luminance = Math.floor(this.luminance(this.Base) * 100);
            const darken = luminance > 50 ? 5 : luminance > 40 ? 10 : luminance > 20 ? 15 : luminance;
            const brighten = luminance > 55 ? 65 : luminance > 45 ? 60 : luminance > 20 ? 55 : luminance > 10 ? 45 : 80;
            this.BrightShade = this.brightness(this.brightness(this.Base, 'darken', darken), 'brighten', brighten);
            this.BrightWarmly = this.brightness(this.brightness(this.saturate(this.Base), 'darken', darken - 10), 'brighten', brighten - 5);
            this.TransparentDarkenVariance = this.brightness(this.transparentize(this.Base, 80), 'darken', 40);
            if (this.isBright(this.Base)) {
                this.ContrastColor = 'rgba(58,65,71,0.5)';
                this.IsBaseBright = true;
            }
            else {
                this.ContrastColor = 'rgb(255,255,255, 0.7)';
                this.IsBaseBright = false;
            }
        }
    }
    saturate(_Rgb) {
        const rgbIntArray = this.getRGBArray(_Rgb);
        const greyVal = this.getLightnessOfRGB(_Rgb) * 55;
        const [lowest, middle, highest] = this.getLowMidHi(rgbIntArray);
        if (lowest.val === highest.val) {
            return _Rgb;
        }
        const saturationRange = Math.round(Math.min(255 - greyVal, greyVal));
        const maxChange = Math.min(255 - highest.val, lowest.val);
        const changeAmount = Math.min(saturationRange / 10, maxChange);
        const middleValueRatio = (greyVal - middle.val) / (greyVal - highest.val) + 0.07;
        const returnArray = [];
        returnArray[highest.index] = Math.round(highest.val + changeAmount);
        returnArray[lowest.index] = Math.round(lowest.val - changeAmount);
        returnArray[middle.index] = Math.round(greyVal + (returnArray[highest.index] - greyVal) * middleValueRatio + 5);
        return `rgb(${[returnArray].join()})`;
    }
    brightness(_Rgb, _Action, _Percentage) {
        const rgbIntArray = this.getRGBArray(_Rgb);
        const [lowest, middle, highest] = this.getLowMidHi(rgbIntArray);
        if (_Action === 'brighten' && lowest.val === 255) {
            return _Rgb;
        }
        if (_Action === 'darken' && highest.val === 0) {
            return _Rgb;
        }
        const amount = (_Percentage / 100) * 255;
        let returnList = [];
        if (_Action === 'brighten') {
            returnList[lowest.index] = Math.round(lowest.val + Math.min(255 - lowest.val, amount));
            const increaseFraction = (returnList[lowest.index] - lowest.val) / (255 - lowest.val);
            returnList[middle.index] = middle.val + (255 - middle.val) * increaseFraction;
            returnList[highest.index] = highest.val + (255 - highest.val) * increaseFraction;
        }
        if (_Action === 'darken') {
            returnList[highest.index] = highest.val - Math.min(highest.val, amount);
            const decreaseFraction = (highest.val - returnList[highest.index]) / highest.val;
            returnList[middle.index] = middle.val - middle.val * decreaseFraction;
            returnList[lowest.index] = lowest.val - lowest.val * decreaseFraction;
        }
        returnList = returnList.map(item => Math.round(item));
        if (rgbIntArray.length > 3) {
            returnList.push(rgbIntArray[3]);
            return `rgba(${returnList.join()})`;
        }
        return `rgb(${returnList.join()})`;
    }
    getLightnessOfRGB(_Rgb) {
        const rgbIntArray = this.getRGBArray(_Rgb);
        const highest = Math.max(...rgbIntArray);
        const lowest = Math.min(...rgbIntArray);
        return (highest + lowest) / 2 / 255;
    }
    isBright(_Rgb) {
        return this.contrast(this.luminance(_Rgb));
    }
    getLowMidHi(_RgbArray) {
        const rgbArrayCopy = _RgbArray.slice();
        const rgbArrayWithoutAlpha = _RgbArray.length > 3 ? rgbArrayCopy.reverse().slice(1).reverse() : _RgbArray;
        let highest = { val: -1, index: -1 };
        let lowest = { val: Infinity, index: -1 };
        rgbArrayWithoutAlpha.map((val, index) => {
            if (val > highest.val) {
                highest = { val: val, index: index };
            }
            if (val < lowest.val) {
                lowest = { val: val, index: index };
            }
        });
        if (lowest.index === highest.index) {
            lowest.index = highest.index + 1;
        }
        const middleIndex = 3 - highest.index - lowest.index;
        const middle = {
            val: rgbArrayWithoutAlpha[middleIndex],
            index: middleIndex
        };
        return [lowest, middle, highest];
    }
    contrast(_Luminance) {
        const brightest = Math.max(1.05, _Luminance + 0.05);
        const darkest = Math.min(1.05, _Luminance + 0.05);
        const contrast = brightest / darkest;
        return contrast < 2.7;
    }
    isColor(_StrColor) {
        const CSSDeclaration = new Option().style;
        CSSDeclaration.color = _StrColor;
        return CSSDeclaration.color ? CSSDeclaration.color : null;
    }
    getRGBArray(_Rgb) {
        return _Rgb
            .replace(/^(rgb|rgba)\(/, '')
            .replace(/\)$/, '')
            .replace(/\s/g, '')
            .split(',')
            .map(x => +x);
    }
    luminance(_Rgb) {
        const rgbIntArray = this.getRGBArray(_Rgb);
        const W3algorithm = rgbIntArray.map(item => {
            item /= 255;
            return item <= 0.03928 ? item / 12.92 : Math.pow((item + 0.055) / 1.055, 2.4);
        });
        return W3algorithm[0] * 0.2126 + W3algorithm[1] * 0.7152 + W3algorithm[2] * 0.0722;
    }
    transparentize(_Rgb, _Percentage) {
        const baseArray = this.Base.replace(/^(rgb|rgba)\(/, '')
            .replace(/\)$/, '')
            .replace(/\s/g, '')
            .split(',')
            .map(x => +x);
        if (baseArray.length > 3) {
            baseArray.pop();
        }
        const amount = (100 - _Percentage) / 100;
        baseArray.push(amount);
        return `rgb(${baseArray.join()})`;
    }
}
export class DataControl {
    copyValuesFrom(_Data, _DestinationObject) {
        if (typeof _Data !== 'object') {
            return _DestinationObject;
        }
        const dataKeys = Object.keys(_Data);
        const destinationObjectKeys = Object.keys(_DestinationObject);
        dataKeys.forEach(key => {
            if (destinationObjectKeys.find(tKey => tKey === key || tKey === '_' + key)) {
                if (key.includes('Date')) {
                    const date = Date.parse(_Data[key]);
                    if (date) {
                        _DestinationObject[key] = new Date(date);
                    }
                    else {
                        if (_Data[key] !== null) {
                            _DestinationObject[key] = _Data[key];
                        }
                    }
                }
                else {
                    if (_Data[key] !== null) {
                        _DestinationObject[key] = _Data[key];
                    }
                }
            }
        });
        return _DestinationObject;
    }
}
export class Timer {
    constructor() {
        this.TimePassed = 0;
        this.Progress = 0;
        this.Remaining = 100;
    }
    setMilliseconds(_Milliseconds) {
        this.Milliseconds = _Milliseconds;
    }
    reset() {
        this.TimePassed = 0;
        this.Progress = 0;
    }
    pause() {
        this.TimePassed = 0;
        this.Progress = 0;
    }
    stop() {
        this.TimePassed = 0;
        clearInterval(this.Timer);
    }
    start() {
        this.Timer = setInterval(() => {
            if (this.TimePassed >= this.Milliseconds) {
                clearInterval(this.Timer);
                return;
            }
            this.TimePassed += 100;
            this.Progress = (this.TimePassed * 100) / this.Milliseconds;
            this.Remaining = 100 - this.Progress;
        }, 100);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2xvYmFsLWNsYXNzZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9uZ3gtYXdlc29tZS1wb3B1cC9jb3JlL2dsb2JhbC1jbGFzc2VzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUc5QyxNQUFNLE9BQU8sS0FBSztJQUFsQjtRQUNFLFVBQUssR0FBVyxJQUFJLENBQUM7UUFDckIsYUFBUSxHQUFXLElBQUksQ0FBQztRQUN4QixhQUFRLEdBQVcsSUFBSSxDQUFDO1FBQ3hCLFdBQU0sR0FBVyxJQUFJLENBQUM7UUFDdEIsY0FBUyxHQUFXLElBQUksQ0FBQztRQUN6QixjQUFTLEdBQVcsSUFBSSxDQUFDO1FBQ3pCLGVBQVUsR0FBWSxJQUFJLENBQUM7SUFDN0IsQ0FBQztDQUFBO0FBRUQsTUFBTSxPQUFPLFFBQVE7SUFBckI7UUFDRSxVQUFLLEdBQVcsSUFBSSxDQUFDO1FBQ3JCLFlBQU8sR0FBVyxJQUFJLENBQUM7SUFDekIsQ0FBQztDQUFBO0FBRUQsTUFBTSxPQUFPLFdBQVc7SUFDdEIsWUFBbUIsS0FBYSxFQUFTLEVBQVUsRUFBUyxhQUFrQyxtQkFBbUIsQ0FBQyxPQUFPO1FBQXRHLFVBQUssR0FBTCxLQUFLLENBQVE7UUFBUyxPQUFFLEdBQUYsRUFBRSxDQUFRO1FBQVMsZUFBVSxHQUFWLFVBQVUsQ0FBbUQ7SUFBRyxDQUFDO0NBQzlIO0FBRUQsTUFBTSxPQUFPLGdCQUFnQjtJQUczQixZQUFZLGlCQUFvQztRQUZoRCxjQUFTLEdBQWdCLElBQUksVUFBVSxFQUFFLENBQUM7UUFHeEMsSUFBSSxpQkFBaUIsRUFBRTtZQUNyQixNQUFNLFdBQVcsR0FBRyxJQUFJLFdBQVcsRUFBRSxDQUFDO1lBQ3RDLFdBQVcsQ0FBQyxjQUFjLENBQUMsaUJBQWlCLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFDcEQsTUFBTSxTQUFTLEdBQUcsSUFBSSxVQUFVLEVB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Q0FBQyxDQUFDO1lBQzlELE1BQU0sTUFBTSxHQUFHLFNBQVMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztZQUMxRixNQUFNLFFBQVEsR0FBRyxTQUFTLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztZQUM1RyxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLENBQUMsRUFBRSxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDdkcsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsUUFBUSxFQUFFLE1BQU0sR0FBRyxFQUFFLENBQUMsRUFBRSxVQUFVLEVBQUUsUUFBUSxHQUFHLENBQUMsQ0FBQyxDQUFDO1lBQ2hJLElBQUksQ0FBQyx5QkFBeUIsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDbkcsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLElB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LElBQUksQ0FBQyxVQUFVLEdBQUcsQ0FBQyxDQUFDO1FBQ3BCLElBQUksQ0FBQyxRQUFRLEdBQUcsQ0FBQyxDQUFDO0lBQ3BCLENBQUM7SUFFRCxLQUFLO1FBQ0gsSUFBSSxDQUFDLFVBQVUsR0FBRyxDQUFDLENBQUM7UUFDcEIsSUFBSSxDQUFDLFFBQVEsR0FBRyxDQUFDLENBQUM7SUFDcEIsQ0FBQztJQUVELElBQUk7UUFDRixJQUFJLENBQUMsVUFBVSxHQUFHLENBQUMsQ0FBQztRQUNwQixhQUFhLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFFRCxLQUFLO1FBQ0gsSUFBSSxDQUFDLEtBQUssR0FBRyxXQUFXLENBQUMsR0FBRyxFQUFFO1lBQzVCLElBQUksSUFBSSxDQUFDLFVBQVUsSUFBSSxJQUFJLENBQUMsWUFBWSxFQUFFO2dCQUN4QyxhQUFhLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUMxQixPQUFPO2FBQ1I7WUFDRCxJQUFJLENBQUMsVUFBVSxJQUFJLEdBQUcsQ0FBQztZQUN2QixJQUFJLENBQUMsUUFBUSxHQUFHLENBQUMsSUFBSSxDQUFDLFVBQVUsR0FBRyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDO1lBQzVELElBQUksQ0FBQyxTQUFTLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7UUFDdkMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQ1YsQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQnV0dG9uTGF5b3V0RGlzcGxheSB9IGZyb20gJy4vZW51bXMnO1xuaW1wb3J0IHsgSUJ1dHRvbiwgSUNvbG9yT2JqZWN0LCBJQ29sb3JUeXBlcywgSUdsb2JhbENvbmZpZywgSUdsb2JhbFVzZXJDb25maWcsIElTaXplcyB9IGZyb20gJy4vZ2xvYmFsLWludGVyZmFjZXMnO1xuXG5leHBvcnQgY2xhc3MgU2l6ZXMgaW1wbGVtZW50cyBJU2l6ZXMge1xuICB3aWR0aDogc3RyaW5nID0gbnVsbDtcbiAgbWluV2lkdGg6IHN0cmluZyA9IG51bGw7XG4gIG1heFdpZHRoOiBzdHJpbmcgPSBudWxsO1xuICBoZWlnaHQ6IHN0cmluZyA9IG51bGw7XG4gIG1pbkhlaWdodDogc3RyaW5nID0gbnVsbDtcbiAgbWF4SGVpZ2h0OiBzdHJpbmcgPSBudWxsO1xuICBmdWxsU2NyZWVuOiBib29sZWFuID0gbnVsbDtcbn1cblxuZXhwb3J0IGNsYXNzIGRpc3BhdGNoIHtcbiAgdGl0bGU6IHN0cmluZyA9IG51bGw7XG4gIG1lc3NhZ2U6IHN0cmluZyA9IG51bGw7XG59XG5cbmV4cG9ydCBjbGFzcyBCdXR0b25NYWtlciBpbXBsZW1lbnRzIElCdXR0b24ge1xuICBjb25zdHJ1Y3RvcihwdWJsaWMgbGFiZWw6IHN0cmluZywgcHVibGljIElEOiBzdHJpbmcsIHB1YmxpYyBsYXlvdXRUeXBlOiBCdXR0b25MYXlvdXREaXNwbGF5ID0gQnV0dG9uTGF5b3V0RGlzcGxheS5QUklNQVJZKSB7fVxufVxuXG5leHBvcnQgY2xhc3MgR2xvYmFsVXNlckNvbmZpZyBpbXBsZW1lbnRzIElHbG9iYWxVc2VyQ29uZmlnIHtcbiAgY29sb3JMaXN0OiBJQ29sb3JUeXBlcyA9IG5ldyBDb2xvclR5cGVzKCk7XG5cbiAgY29uc3RydWN0b3IoX0dsb2JhbFVzZXJDb25maWc6IElHbG9iYWxVc2VyQ29uZmlnKSB7XG4gICAgaWYgKF9HbG9iYWxVc2VyQ29uZmlnKSB7XG4gICAgICBjb25zdCBkYXRhQ29udHJvbCA9IG5ldyBEYXRhQ29udHJvbCgpO1xuICAgICAgZGF0YUNvbnRyb2wuY29weVZhbHVlc0Zyb20oX0dsb2JhbFVzZXJDb25maWcsIHRoaXMpO1xuICAgICAgY29uc3QgY29sb3JMaXN0ID0gbmV3IENvbG9yVHlwZXMoKTtcbiAgICAgIHRoaXMuY29sb3JMaXN0ID0gZGF0YUNvbnRyb2wuY29weVZhbHVlc0Zyb20odGhpcy5jb2xvckxpc3QsIGNvbG9yTGlzdCk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBDb2xvclR5cGVzIGltcGxlbWVudHMgSUNvbG9yVHlwZXMge1xuICBwcmltYXJ5OiBzdHJpbmcgPSBudWxsO1xuICBzZWNvbmRhcnk6IHN0cmluZyA9IG51bGw7XG4gIHN1Y2Nlc3M6IHN0cmluZyA9IG51bGw7XG4gIGluZm86IHN0cmluZyA9IG51bGw7XG4gIHdhcm5pbmc6IHN0cmluZyA9IG51bGw7XG4gIGRhbmdlcjogc3RyaW5nID0gbnVsbDtcbiAgbGlnaHQ6IHN0cmluZyA9IG51bGw7XG4gIGRhcms6IHN0cmluZyA9IG51bGw7XG4gIGN1c3RvbU9uZTogc3RyaW5nID0gbnVsbDtcbiAgY3VzdG9tVHdvOiBzdHJpbmcgPSBudWxsO1xuICBjdXN0b21UaHJlZTogc3RyaW5nID0gbnVsbDtcbiAgY3VzdG9tRm91cjogc3RyaW5nID0gbnVsbDtcbiAgY3VzdG9tRml2ZTogc3RyaW5nID0gbnVsbDtcbn1cblxuZXhwb3J0IGNsYXNzIEdsb2JhbENvbmZpZyBpbXBsZW1lbnRzIElHbG9iYWxDb25maWcge1xuICBkaXNwbGF5Q29sb3I6IElDb2xvck9iamVjdCA9IG5ldyBEaXNwbGF5Q29sb3IoKTtcbn1cblxuZXhwb3J0IGNsYXNzIERpc3BsYXlDb2xvciBpbXBsZW1lbnRzIElDb2xvck9iamVjdCB7XG4gIHByaW1hcnk6IENvbG9yUHJvdmlkZXIgPSBudWxsO1xuICBzZWNvbmRhcnk6IENvbG9yUHJvdmlkZXIgPSBudWxsO1xuICBzdWNjZXNzOiBDb2xvclByb3ZpZGVyID0gbnVsbDtcbiAgaW5mbzogQ29sb3JQcm92aWRlciA9IG51bGw7XG4gIHdhcm5pbmc6IENvbG9yUHJvdmlkZXIgPSBudWxsO1xuICBkYW5nZXI6IENvbG9yUHJvdmlkZXIgPSBudWxsO1xuICBsaWdodDogQ29sb3JQcm92aWRlciA9IG51bGw7XG4gIGRhcms6IENvbG9yUHJvdmlkZXIgPSBudWxsO1xuICBjdXN0b21PbmU6IENvbG9yUHJvdmlkZXIgPSBudWxsO1xuICBjdXN0b21Ud286IENvbG9yUHJvdmlkZXIgPSBudWxsO1xuICBjdXN0b21UaHJlZTogQ29sb3JQcm92aWRlciA9IG51bGw7XG4gIGN1c3RvbUZvdXI6IENvbG9yUHJvdmlkZXIgPSBudWxsO1xuICBjdXN0b21GaXZlOiBDb2xvclByb3ZpZGVyID0gbnVsbDtcbn1cblxuZXhwb3J0IGNsYXNzIENvbG9yUHJvdmlkZXIge1xuICBCYXNlOiBzdHJpbmcgPSBudWxsO1xuICBCcmlnaHRlbjogc3RyaW5nID0gbnVsbDtcbiAgQnJpZ2h0ZW5Gb3JTaGFkZTogc3RyaW5nID0gbnVsbDtcbiAgRGFya2VuOiBzdHJpbmcgPSBudWxsO1xuICBEYXJrZW5Gb3JTaGFkZTogc3RyaW5nID0gbnVsbDtcbiAgQ29udHJhc3RDb2xvcjogc3RyaW5nID0gbnVsbDtcbiAgVHJhbnNwYXJlbnREYXJrZW5WYXJpYW5jZTogc3RyaW5nID0gbnVsbDtcbiAgQnJpZ2h0U2hhZGU6IHN0cmluZyA9IG51bGw7XG4gIEJyaWdodFdhcm1seTogc3RyaW5nID0gbnVsbDtcbiAgSXNCYXNlQnJpZ2h0OiBib29sZWFuID0gbnVsbDtcblxuICBjb25zdHJ1Y3RvcihfQ29sb3I6IHN0cmluZykge1xuICAgIGlmICgodGhpcy5CYXNlID0gdGhpcy5pc0NvbG9yKF9Db2xvcikpKSB7XG4gICAgICB0aGlzLkJyaWdodGVuID0gdGhpcy5icmlnaHRuZXNzKHRoaXMuQmFzZSwgJ2JyaWdodGVuJywgMjUpO1xuICAgICAgdGhpcy5CcmlnaHRlbkZvclNoYWRlID0gdGhpcy5icmlnaHRuZXNzKHRoaXMuQmFzZSwgJ2JyaWdodGVuJywgMTApO1xuICAgICAgdGhpcy5EYXJrZW4gPSB0aGlzLmJyaWdodG5lc3ModGhpcy5CYXNlLCAnZGFya2VuJywgMjApO1xuICAgICAgdGhpcy5EYXJrZW5Gb3JTaGFkZSA9IHRoaXMuYnJpZ2h0bmVzcyh0aGlzLkJhc2UsICdkYXJrZW4nLCAxMCk7XG4gICAgICBjb25zdCBsdW1pbmFuY2UgPSBNYXRoLmZsb29yKHRoaXMubHVtaW5hbmNlKHRoaXMuQmFzZSkgKiAxMDApO1xuICAgICAgY29uc3QgZGFya2VuID0gbHVtaW5hbmNlID4gNTAgPyA1IDogbHVtaW5hbmNlID4gNDAgPyAxMCA6IGx1bWluYW5jZSA+IDIwID8gMTUgOiBsdW1pbmFuY2U7XG4gICAgICBjb25zdCBicmlnaHRlbiA9IGx1bWluYW5jZSA+IDU1ID8gNjUgOiBsdW1pbmFuY2UgPiA0NSA/IDYwIDogbHVtaW5hbmNlID4gMjAgPyA1NSA6IGx1bWluYW5jZSA+IDEwID8gNDUgOiA4MDtcbiAgICAgIHRoaXMuQnJpZ2h0U2hhZGUgPSB0aGlzLmJyaWdodG5lc3ModGhpcy5icmlnaHRuZXNzKHRoaXMuQmFzZSwgJ2RhcmtlbicsIGRhcmtlbiksICdicmlnaHRlbicsIGJyaWdodGVuKTtcbiAgICAgIHRoaXMuQnJpZ2h0V2FybWx5ID0gdGhpcy5icmlnaHRuZXNzKHRoaXMuYnJpZ2h0bmVzcyh0aGlzLnNhdHVyYXRlKHRoaXMuQmFzZSksICdkYXJrZW4nLCBkYXJrZW4gLSAxMCksICdicmlnaHRlbicsIGJyaWdodGVuIC0gNSk7XG4gICAgICB0aGlzLlRyYW5zcGFyZW50RGFya2VuVmFyaWFuY2UgPSB0aGlzLmJyaWdodG5lc3ModGhpcy50cmFuc3BhcmVudGl6ZSh0aGlzLkJhc2UsIDgwKSwgJ2RhcmtlbicsIDQwKTtcbiAgICAgIGlmICh0aGlzLmlzQnJpZ2h0KHRoaXMuQmFzZSkpIHtcbiAgICAgICAgdGhpcy5Db250cmFzdENvbG9yID0gJ3JnYmEoNTgsNjUsNzEsMC41KSc7XG4gICAgICAgIHRoaXMuSXNCYXNlQnJpZ2h0ID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuQ29udHJhc3RDb2xvciA9ICdyZ2IoMjU1LDI1NSwyNTUsIDAuNyknO1xuICAgICAgICB0aGlzLklzQmFzZUJyaWdodCA9IGZhbHNlO1xuICAgICAgfVxuXG4gICAgICAvKlx0ICAgICAgIGNvbnNvbGUubG9nKCclYyBCcmlnaHRTaGFkZSAnLCBgYmFja2dyb3VuZDogJHt0aGlzLkJyaWdodFNoYWRlfTsgY29sb3I6ICR7dGhpcy5Db250cmFzdENvbG9yfWAsIHRoaXMuQnJpZ2h0U2hhZGUpO1xuXHRcdFx0XHRcdCAgICAgICBjb25zb2xlLmxvZygnJWMgQnJpZ2h0V2FybWx5ICcsIGBiYWNrZ3JvdW5kOiAke3RoaXMuQnJpZ2h0V2FybWx5fTsgY29sb3I6ICR7dGhpcy5Db250cmFzdENvbG9yfWAsIHRoaXMuQnJpZ2h0V2FybWx5KTtcblx0XHRcdFx0XHRcdCAgICAgY29uc29sZS5sb2coJyVjIEJyaWdodGVuICcsIGBiYWNrZ3JvdW5kOiAke3RoaXMuQnJpZ2h0ZW59OyBjb2xvcjogJHt0aGlzLkNvbnRyYXN0Q29sb3J9YCwgdGhpcy5CcmlnaHRlbik7XG5cdFx0XHRcdFx0XHQgICAgIGNvbnNvbGUubG9nKCclYyBCcmlnaHRlbkZvclNoYWRlICcsIGBiYWNrZ3JvdW5kOiAke3RoaXMuQnJpZ2h0ZW5Gb3JTaGFkZX07IGNvbG9yOiAke3RoaXMuQ29udHJhc3RDb2xvcn1gLCB0aGlzLkJyaWdodGVuRm9yU2hhZGUpO1xuXHRcdFx0XHRcdCAgICAgICBjb25zb2xlLmxvZygnJWMgQmFzZSAnLCBgYmFja2dyb3VuZDogJHt0aGlzLkJhc2V9OyBjb2xvcjogJHt0aGlzLkNvbnRyYXN0Q29sb3J9YCwgdGhpcy5CYXNlKTtcblx0XHRcdFx0XHQgICAgICAgY29uc29sZS5sb2coJyVjIERhcmtlbkZvclNoYWRlICcsIGBiYWNrZ3JvdW5kOiAke3RoaXMuRGFya2VuRm9yU2hhZGV9OyBjb2xvcjogJHt0aGlzLkNvbnRyYXN0Q29sb3J9YCwgdGhpcy5EYXJrZW5Gb3JTaGFkZSk7XG5cdFx0XHRcdFx0ICAgICAgIGNvbnNvbGUubG9nKCclYyBEYXJrZW4gJywgYGJhY2tncm91bmQ6ICR7dGhpcy5EYXJrZW59OyBjb2xvcjogJHt0aGlzLkNvbnRyYXN0Q29sb3J9YCwgdGhpcy5EYXJrZW4pO1xuXHRcdFx0XHRcdFx0ICAgICBjb25zb2xlLmxvZygnJWMgVHJhbnNwYXJlbnREYXJrZW5WYXJpYW5jZSAnLCBgYmFja2dyb3VuZDogJHt0aGlzLlRyYW5zcGFyZW50RGFya2VuVmFyaWFuY2V9OyBjb2xvcjogJHt0aGlzLkNvbnRyYXN0Q29sb3J9YCwgdGhpcy5UcmFuc3BhcmVudERhcmtlblZhcmlhbmNlKTtcblx0XHRcdCovXG4gICAgfVxuICB9XG5cbiAgc2F0dXJhdGUoX1JnYjogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCByZ2JJbnRBcnJheSA9IHRoaXMuZ2V0UkdCQXJyYXkoX1JnYik7XG4gICAgY29uc3QgZ3JleVZhbCA9IHRoaXMuZ2V0TGlnaHRuZXNzT2ZSR0IoX1JnYikgKiA1NTtcbiAgICBjb25zdCBbbG93ZXN0LCBtaWRkbGUsIGhpZ2hlc3RdID0gdGhpcy5nZXRMb3dNaWRIaShyZ2JJbnRBcnJheSk7XG5cbiAgICBpZiAobG93ZXN0LnZhbCA9PT0gaGlnaGVzdC52YWwpIHtcbiAgICAgIHJldHVybiBfUmdiO1xuICAgIH1cblxuICAgIGNvbnN0IHNhdHVyYXRpb25SYW5nZSA9IE1hdGgucm91bmQoTWF0aC5taW4oMjU1IC0gZ3JleVZhbCwgZ3JleVZhbCkpO1xuICAgIGNvbnN0IG1heENoYW5nZSA9IE1hdGgubWluKDI1NSAtIGhpZ2hlc3QudmFsLCBsb3dlc3QudmFsKTtcbiAgICBjb25zdCBjaGFuZ2VBbW91bnQgPSBNYXRoLm1pbihzYXR1cmF0aW9uUmFuZ2UgLyAxMCwgbWF4Q2hhbmdlKTtcbiAgICBjb25zdCBtaWRkbGVWYWx1ZVJhdGlvID0gKGdyZXlWYWwgLSBtaWRkbGUudmFsKSAvIChncmV5VmFsIC0gaGlnaGVzdC52YWwpICsgMC4wNztcblxuICAgIGNvbnN0IHJldHVybkFycmF5ID0gW107XG4gICAgcmV0dXJuQXJyYXlbaGlnaGVzdC5pbmRleF0gPSBNYXRoLnJvdW5kKGhpZ2hlc3QudmFsICsgY2hhbmdlQW1vdW50KTtcbiAgICByZXR1cm5BcnJheVtsb3dlc3QuaW5kZXhdID0gTWF0aC5yb3VuZChsb3dlc3QudmFsIC0gY2hhbmdlQW1vdW50KTtcbiAgICByZXR1cm5BcnJheVttaWRkbGUuaW5kZXhdID0gTWF0aC5yb3VuZChncmV5VmFsICsgKHJldHVybkFycmF5W2hpZ2hlc3QuaW5kZXhdIC0gZ3JleVZhbCkgKiBtaWRkbGVWYWx1ZVJhdGlvICsgNSk7XG4gICAgcmV0dXJuIGByZ2IoJHtbcmV0dXJuQXJyYXldLmpvaW4oKX0pYDtcbiAgfVxuXG4gIHB1YmxpYyBicmlnaHRuZXNzKF9SZ2I6IHN0cmluZywgX0FjdGlvbjogJ2JyaWdodGVuJyB8ICdkYXJrZW4nLCBfUGVyY2VudGFnZTogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCByZ2JJbnRBcnJheSA9IHRoaXMuZ2V0UkdCQXJyYXkoX1JnYik7XG4gICAgY29uc3QgW2xvd2VzdCwgbWlkZGxlLCBoaWdoZXN0XSA9IHRoaXMuZ2V0TG93TWlkSGkocmdiSW50QXJyYXkpO1xuXG4gICAgaWYgKF9BY3Rpb24gPT09ICdicmlnaHRlbicgJiYgbG93ZXN0LnZhbCA9PT0gMjU1KSB7XG4gICAgICByZXR1cm4gX1JnYjtcbiAgICB9XG5cbiAgICBpZiAoX0FjdGlvbiA9PT0gJ2RhcmtlbicgJiYgaGlnaGVzdC52YWwgPT09IDApIHtcbiAgICAgIHJldHVybiBfUmdiO1xuICAgIH1cblxuICAgIGNvbnN0IGFtb3VudCA9IChfUGVyY2VudGFnZSAvIDEwMCkgKiAyNTU7XG5cbiAgICBsZXQgcmV0dXJuTGlzdCA9IFtdO1xuXG4gICAgaWYgKF9BY3Rpb24gPT09ICdicmlnaHRlbicpIHtcbiAgICAgIHJldHVybkxpc3RbbG93ZXN0LmluZGV4XSA9IE1hdGgucm91bmQobG93ZXN0LnZhbCArIE1hdGgubWluKDI1NSAtIGxvd2VzdC52YWwsIGFtb3VudCkpO1xuICAgICAgY29uc3QgaW5jcmVhc2VGcmFjdGlvbiA9IChyZXR1cm5MaXN0W2xvd2VzdC5pbmRleF0gLSBsb3dlc3QudmFsKSAvICgyNTUgLSBsb3dlc3QudmFsKTtcbiAgICAgIHJldHVybkxpc3RbbWlkZGxlLmluZGV4XSA9IG1pZGRsZS52YWwgKyAoMjU1IC0gbWlkZGxlLnZhbCkgKiBpbmNyZWFzZUZyYWN0aW9uO1xuICAgICAgcmV0dXJuTGlzdFtoaWdoZXN0LmluZGV4XSA9IGhpZ2hlc3QudmFsICsgKDI1NSAtIGhpZ2hlc3QudmFsKSAqIGluY3JlYXNlRnJhY3Rpb247XG4gICAgfVxuICAgIGlmIChfQWN0aW9uID09PSAnZGFya2VuJykge1xuICAgICAgcmV0dXJuTGlzdFtoaWdoZXN0LmluZGV4XSA9IGhpZ2hlc3QudmFsIC0gTWF0aC5taW4oaGlnaGVzdC52YWwsIGFtb3VudCk7XG4gICAgICBjb25zdCBkZWNyZWFzZUZyYWN0aW9uID0gKGhpZ2hlc3QudmFsIC0gcmV0dXJuTGlzdFtoaWdoZXN0LmluZGV4XSkgLyBoaWdoZXN0LnZhbDtcbiAgICAgIHJldHVybkxpc3RbbWlkZGxlLmluZGV4XSA9IG1pZGRsZS52YWwgLSBtaWRkbGUudmFsICogZGVjcmVhc2VGcmFjdGlvbjtcbiAgICAgIHJldHVybkxpc3RbbG93ZXN0LmluZGV4XSA9IGxvd2VzdC52YWwgLSBsb3dlc3QudmFsICogZGVjcmVhc2VGcmFjdGlvbjtcbiAgICB9XG5cbiAgICByZXR1cm5MaXN0ID0gcmV0dXJuTGlzdC5tYXAoaXRlbSA9PiBNYXRoLnJvdW5kKGl0ZW0pKTtcbiAgICBpZiAocmdiSW50QXJyYXkubGVuZ3RoID4gMykge1xuICAgICAgcmV0dXJuTGlzdC5wdXNoKHJnYkludEFycmF5WzNdKTtcbiAgICAgIHJldHVybiBgcmdiYSgke3JldHVybkxpc3Quam9pbigpfSlgO1xuICAgIH1cbiAgICByZXR1cm4gYHJnYigke3JldHVybkxpc3Quam9pbigpfSlgO1xuICB9XG5cbiAgZ2V0TGlnaHRuZXNzT2ZSR0IoX1JnYjogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBjb25zdCByZ2JJbnRBcnJheSA9IHRoaXMuZ2V0UkdCQXJyYXkoX1JnYik7XG5cbiAgICBjb25zdCBoaWdoZXN0ID0gTWF0aC5tYXgoLi4ucmdiSW50QXJyYXkpO1xuICAgIGNvbnN0IGxvd2VzdCA9IE1hdGgubWluKC4uLnJnYkludEFycmF5KTtcbiAgICByZXR1cm4gKGhpZ2hlc3QgKyBsb3dlc3QpIC8gMiAvIDI1NTtcbiAgfVxuXG4gIHByaXZhdGUgaXNCcmlnaHQoX1JnYjogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuY29udHJhc3QodGhpcy5sdW1pbmFuY2UoX1JnYikpO1xuICB9XG5cbiAgLy9cbiAgcHJpdmF0ZSBnZXRMb3dNaWRIaShfUmdiQXJyYXk6IG51bWJlcltdKTogeyBpbmRleDogbnVtYmVyOyB2YWw6IG51bWJlciB9W10ge1xuICAgIGNvbnN0IHJnYkFycmF5Q29weSA9IF9SZ2JBcnJheS5zbGljZSgpO1xuICAgIGNvbnN0IHJnYkFycmF5V2l0aG91dEFscGhhID0gX1JnYkFycmF5Lmxlbmd0aCA+IDMgPyByZ2JBcnJheUNvcHkucmV2ZXJzZSgpLnNsaWNlKDEpLnJldmVyc2UoKSA6IF9SZ2JBcnJheTtcbiAgICBsZXQgaGlnaGVzdCA9IHsgdmFsOiAtMSwgaW5kZXg6IC0xIH07XG4gICAgbGV0IGxvd2VzdCA9IHsgdmFsOiBJbmZpbml0eSwgaW5kZXg6IC0xIH07XG5cbiAgICByZ2JBcnJheVdpdGhvdXRBbHBoYS5tYXAoKHZhbCwgaW5kZXgpID0+IHtcbiAgICAgIGlmICh2YWwgPiBoaWdoZXN0LnZhbCkge1xuICAgICAgICBoaWdoZXN0ID0geyB2YWw6IHZhbCwgaW5kZXg6IGluZGV4IH07XG4gICAgICB9XG4gICAgICBpZiAodmFsIDwgbG93ZXN0LnZhbCkge1xuICAgICAgICBsb3dlc3QgPSB7IHZhbDogdmFsLCBpbmRleDogaW5kZXggfTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChsb3dlc3QuaW5kZXggPT09IGhpZ2hlc3QuaW5kZXgpIHtcbiAgICAgIGxvd2VzdC5pbmRleCA9IGhpZ2hlc3QuaW5kZXggKyAxO1xuICAgIH1cblxuICAgIGNvbnN0IG1pZGRsZUluZGV4ID0gMyAtIGhpZ2hlc3QuaW5kZXggLSBsb3dlc3QuaW5kZXg7XG4gICAgY29uc3QgbWlkZGxlID0ge1xuICAgICAgdmFsOiByZ2JBcnJheVdpdGhvdXRBbHBoYVttaWRkbGVJbmRleF0sXG4gICAgICBpbmRleDogbWlkZGxlSW5kZXhcbiAgICB9O1xuICAgIHJldHVybiBbbG93ZXN0LCBtaWRkbGUsIGhpZ2hlc3RdO1xuICB9XG5cbiAgcHJpdmF0ZSBjb250cmFzdChfTHVtaW5hbmNlKTogYm9vbGVhbiB7XG4gICAgY29uc3QgYnJpZ2h0ZXN0ID0gTWF0aC5tYXgoMS4wNSwgX0x1bWluYW5jZSArIDAuMDUpO1xuICAgIGNvbnN0IGRhcmtlc3QgPSBNYXRoLm1pbigxLjA1LCBfTHVtaW5hbmNlICsgMC4wNSk7XG4gICAgY29uc3QgY29udHJhc3QgPSBicmlnaHRlc3QgLyBkYXJrZXN0O1xuICAgIHJldHVybiBjb250cmFzdCA8IDIuNztcbiAgfVxuXG4gIHByaXZhdGUgaXNDb2xvcihfU3RyQ29sb3IpOiBzdHJpbmcge1xuICAgIGNvbnN0IENTU0RlY2xhcmF0aW9uID0gbmV3IE9wdGlvbigpLnN0eWxlO1xuICAgIENTU0RlY2xhcmF0aW9uLmNvbG9yID0gX1N0ckNvbG9yO1xuICAgIHJldHVybiBDU1NEZWNsYXJhdGlvbi5jb2xvciA/IENTU0RlY2xhcmF0aW9uLmNvbG9yIDogbnVsbDtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0UkdCQXJyYXkoX1JnYjogc3RyaW5nKTogbnVtYmVyW10ge1xuICAgIHJldHVybiBfUmdiXG4gICAgICAucmVwbGFjZSgvXihyZ2J8cmdiYSlcXCgvLCAnJylcbiAgICAgIC5yZXBsYWNlKC9cXCkkLywgJycpXG4gICAgICAucmVwbGFjZSgvXFxzL2csICcnKVxuICAgICAgLnNwbGl0KCcsJylcbiAgICAgIC5tYXAoeCA9PiAreCk7XG4gIH1cblxuICBwcml2YXRlIGx1bWluYW5jZShfUmdiOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIGNvbnN0IHJnYkludEFycmF5ID0gdGhpcy5nZXRSR0JBcnJheShfUmdiKTtcbiAgICBjb25zdCBXM2FsZ29yaXRobSA9IHJnYkludEFycmF5Lm1hcChpdGVtID0+IHtcbiAgICAgIGl0ZW0gLz0gMjU1O1xuICAgICAgcmV0dXJuIGl0ZW0gPD0gMC4wMzkyOCA/IGl0ZW0gLyAxMi45MiA6IE1hdGgucG93KChpdGVtICsgMC4wNTUpIC8gMS4wNTUsIDIuNCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIFczYWxnb3JpdGhtWzBdICogMC4yMTI2ICsgVzNhbGdvcml0aG1bMV0gKiAwLjcxNTIgKyBXM2FsZ29yaXRobVsyXSAqIDAuMDcyMjtcbiAgfVxuXG4gIHByaXZhdGUgdHJhbnNwYXJlbnRpemUoX1JnYjogc3RyaW5nLCBfUGVyY2VudGFnZTogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCBiYXNlQXJyYXkgPSB0aGlzLkJhc2UucmVwbGFjZSgvXihyZ2J8cmdiYSlcXCgvLCAnJylcbiAgICAgIC5yZXBsYWNlKC9cXCkkLywgJycpXG4gICAgICAucmVwbGFjZSgvXFxzL2csICcnKVxuICAgICAgLnNwbGl0KCcsJylcbiAgICAgIC5tYXAoeCA9PiAreCk7XG4gICAgaWYgKGJhc2VBcnJheS5sZW5ndGggPiAzKSB7XG4gICAgICBiYXNlQXJyYXkucG9wKCk7XG4gICAgfVxuICAgIGNvbnN0IGFtb3VudCA9ICgxMDAgLSBfUGVyY2VudGFnZSkgLyAxMDA7XG4gICAgYmFzZUFycmF5LnB1c2goYW1vdW50KTtcbiAgICByZXR1cm4gYHJnYigke2Jhc2VBcnJheS5qb2luKCl9KWA7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIERhdGFDb250cm9sIHtcbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIHB1YmxpYyBjb3B5VmFsdWVzRnJvbShfRGF0YTogYW55LCBfRGVzdGluYXRpb25PYmplY3Q6IGFueSk6IGFueSB7XG4gICAgaWYgKHR5cGVvZiBfRGF0YSAhPT0gJ29iamVjdCcpIHtcbiAgICAgIHJldHVybiBfRGVzdGluYXRpb25PYmplY3Q7XG4gICAgfVxuXG4gICAgY29uc3QgZGF0YUtleXMgPSBPYmplY3Qua2V5cyhfRGF0YSk7XG4gICAgY29uc3QgZGVzdGluYXRpb25PYmplY3RLZXlzID0gT2JqZWN0LmtleXMoX0Rlc3RpbmF0aW9uT2JqZWN0KTtcblxuICAgIGRhdGFLZXlzLmZvckVhY2goa2V5ID0+IHtcbiAgICAgIGlmIChkZXN0aW5hdGlvbk9iamVjdEtleXMuZmluZCh0S2V5ID0+IHRLZXkgPT09IGtleSB8fCB0S2V5ID09PSAnXycgKyBrZXkpKSB7XG4gICAgICAgIGlmIChrZXkuaW5jbHVkZXMoJ0RhdGUnKSkge1xuICAgICAgICAgIGNvbnN0IGRhdGUgPSBEYXRlLnBhcnNlKF9EYXRhW2tleV0pO1xuICAgICAgICAgIGlmIChkYXRlKSB7XG4gICAgICAgICAgICBfRGVzdGluYXRpb25PYmplY3Rba2V5XSA9IG5ldyBEYXRlKGRhdGUpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoX0RhdGFba2V5XSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICBfRGVzdGluYXRpb25PYmplY3Rba2V5XSA9IF9EYXRhW2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChfRGF0YVtrZXldICE9PSBudWxsKSB7XG4gICAgICAgICAgICBfRGVzdGluYXRpb25PYmplY3Rba2V5XSA9IF9EYXRhW2tleV07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gX0Rlc3RpbmF0aW9uT2JqZWN0O1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBUaW1lciB7XG4gIFRpbWVQYXNzZWQgPSAwO1xuICBUaW1lcjogYW55O1xuICBQcm9ncmVzcyA9IDA7XG4gIFJlbWFpbmluZyA9IDEwMDtcbiAgTWlsbGlzZWNvbmRzOiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IoKSB7fVxuXG4gIHNldE1pbGxpc2Vjb25kcyhfTWlsbGlzZWNvbmRzOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLk1pbGxpc2Vjb25kcyA9IF9NaWxsaXNlY29uZHM7XG4gIH1cblxuICByZXNldCgpOiB2b2lkIHtcbiAgICB0aGlzLlRpbWVQYXNzZWQgPSAwO1xuICAgIHRoaXMuUHJvZ3Jlc3MgPSAwO1xuICB9XG5cbiAgcGF1c2UoKTogdm9pZCB7XG4gICAgdGhpcy5UaW1lUGFzc2VkID0gMDtcbiAgICB0aGlzLlByb2dyZXNzID0gMDtcbiAgfVxuXG4gIHN0b3AoKTogdm9pZCB7XG4gICAgdGhpcy5UaW1lUGFzc2VkID0gMDtcbiAgICBjbGVhckludGVydmFsKHRoaXMuVGltZXIpO1xuICB9XG5cbiAgc3RhcnQoKTogdm9pZCB7XG4gICAgdGhpcy5UaW1lciA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGlmICh0aGlzLlRpbWVQYXNzZWQgPj0gdGhpcy5NaWxsaXNlY29uZHMpIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLlRpbWVyKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5UaW1lUGFzc2VkICs9IDEwMDtcbiAgICAgIHRoaXMuUHJvZ3Jlc3MgPSAodGhpcy5UaW1lUGFzc2VkICogMTAwKSAvIHRoaXMuTWlsbGlzZWNvbmRzO1xuICAgICAgdGhpcy5SZW1haW5pbmcgPSAxMDAgLSB0aGlzLlByb2dyZXNzO1xuICAgIH0sIDEwMCk7XG4gIH1cbn1cbiJdfQ==