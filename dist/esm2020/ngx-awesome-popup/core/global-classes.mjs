import { ButtonLayoutDisplay } from './enums';
export class Sizes {
    constructor() {
        this.width = null;
        this.minWidth = null;
        this.maxWidth = null;
        this.height = null;
        this.minHeight = null;
        this.maxHeight = null;
        this.fullScreen = null;
    }
}
export class dispatch {
    constructor() {
        this.title = null;
        this.message = null;
    }
}
export class ButtonMaker {
    constructor(label, ID, layoutType = ButtonLayoutDisplay.PRIMARY, disabled = false) {
        this.label = label;
        this.ID = ID;
        this.layoutType = layoutType;
        this.disabled = disabled;
        this.hidden = false;
    }
    disable() {
        this.disabled = true;
    }
    enable() {
        this.disabled = false;
    }
    hide() {
        this.hidden = true;
    }
    show() {
        this.hidden = false;
    }
}
export class GlobalUserConfig {
    constructor(_GlobalUserConfig) {
        this.colorList = new ColorTypes();
        if (_GlobalUserConfig) {
            const dataControl = new DataControl();
            dataControl.copyValuesFrom(_GlobalUserConfig, this);
            const colorList = new ColorTypes();
            this.colorList = dataControl.copyValuesFrom(this.colorList, colorList);
        }
    }
}
export class ColorTypes {
    constructor() {
        this.primary = null;
        this.secondary = null;
        this.success = null;
        this.info = null;
        this.warning = null;
        this.danger = null;
        this.light = null;
        this.dark = null;
        this.customOne = null;
        this.customTwo = null;
        this.customThree = null;
        this.customFour = null;
        this.customFive = null;
    }
}
export class GlobalConfig {
    constructor() {
        this.displayColor = new DisplayColor();
    }
}
export class DisplayColor {
    constructor() {
        this.primary = null;
        this.secondary = null;
        this.success = null;
        this.info = null;
        this.warning = null;
        this.danger = null;
        this.light = null;
        this.dark = null;
        this.customOne = null;
        this.customTwo = null;
        this.customThree = null;
        this.customFour = null;
        this.customFive = null;
    }
}
export class ColorProvider {
    constructor(_Color) {
        this.Base = null;
        this.Brighten = null;
        this.BrightenForShade = null;
        this.Darken = null;
        this.DarkenForShade = null;
        this.ContrastColor = null;
        this.TransparentDarkenVariance = null;
        this.BrightShade = null;
        this.BrightWarmly = null;
        this.IsBaseBright = null;
        if ((this.Base = this.isColor(_Color))) {
            this.Brighten = this.brightness(this.Base, 'brighten', 25);
            this.BrightenForShade = this.brightness(this.Base, 'brighten', 10);
            this.Darken = this.brightness(this.Base, 'darken', 20);
            this.DarkenForShade = this.brightness(this.Base, 'darken', 10);
            const luminance = Math.floor(this.luminance(this.Base) * 100);
            const darken = luminance > 50 ? 5 : luminance > 40 ? 10 : luminance > 20 ? 15 : luminance;
            const brighten = luminance > 55 ? 65 : luminance > 45 ? 60 : luminance > 20 ? 55 : luminance > 10 ? 45 : 80;
            this.BrightShade = this.brightness(this.brightness(this.Base, 'darken', darken), 'brighten', brighten);
            this.BrightWarmly = this.brightness(this.brightness(this.saturate(this.Base), 'darken', darken - 10), 'brighten', brighten - 5);
            this.TransparentDarkenVariance = this.brightness(this.transparentize(this.Base, 80), 'darken', 40);
            if (this.isBright(this.Base)) {
                this.ContrastColor = 'rgba(58,65,71,0.5)';
                this.IsBaseBright = true;
            }
            else {
                this.ContrastColor = 'rgb(255,255,255, 0.7)';
                this.IsBaseBright = false;
            }
        }
    }
    saturate(_Rgb) {
        const rgbIntArray = this.getRGBArray(_Rgb);
        const greyVal = this.getLightnessOfRGB(_Rgb) * 55;
        const [lowest, middle, highest] = this.getLowMidHi(rgbIntArray);
        if (lowest.val === highest.val) {
            return _Rgb;
        }
        const saturationRange = Math.round(Math.min(255 - greyVal, greyVal));
        const maxChange = Math.min(255 - highest.val, lowest.val);
        const changeAmount = Math.min(saturationRange / 10, maxChange);
        const middleValueRatio = (greyVal - middle.val) / (greyVal - highest.val) + 0.07;
        const returnArray = [];
        returnArray[highest.index] = Math.round(highest.val + changeAmount);
        returnArray[lowest.index] = Math.round(lowest.val - changeAmount);
        returnArray[middle.index] = Math.round(greyVal + (returnArray[highest.index] - greyVal) * middleValueRatio + 5);
        return `rgb(${[returnArray].join()})`;
    }
    brightness(_Rgb, _Action, _Percentage) {
        const rgbIntArray = this.getRGBArray(_Rgb);
        const [lowest, middle, highest] = this.getLowMidHi(rgbIntArray);
        if (_Action === 'brighten' && lowest.val === 255) {
            return _Rgb;
        }
        if (_Action === 'darken' && highest.val === 0) {
            return _Rgb;
        }
        const amount = (_Percentage / 100) * 255;
        let returnList = [];
        if (_Action === 'brighten') {
            returnList[lowest.index] = Math.round(lowest.val + Math.min(255 - lowest.val, amount));
            const increaseFraction = (returnList[lowest.index] - lowest.val) / (255 - lowest.val);
            returnList[middle.index] = middle.val + (255 - middle.val) * increaseFraction;
            returnList[highest.index] = highest.val + (255 - highest.val) * increaseFraction;
        }
        if (_Action === 'darken') {
            returnList[highest.index] = highest.val - Math.min(highest.val, amount);
            const decreaseFraction = (highest.val - returnList[highest.index]) / highest.val;
            returnList[middle.index] = middle.val - middle.val * decreaseFraction;
            returnList[lowest.index] = lowest.val - lowest.val * decreaseFraction;
        }
        returnList = returnList.map(item => Math.round(item));
        if (rgbIntArray.length > 3) {
            returnList.push(rgbIntArray[3]);
            return `rgba(${returnList.join()})`;
        }
        return `rgb(${returnList.join()})`;
    }
    getLightnessOfRGB(_Rgb) {
        const rgbIntArray = this.getRGBArray(_Rgb);
        const highest = Math.max(...rgbIntArray);
        const lowest = Math.min(...rgbIntArray);
        return (highest + lowest) / 2 / 255;
    }
    isBright(_Rgb) {
        return this.contrast(this.luminance(_Rgb));
    }
    getLowMidHi(_RgbArray) {
        const rgbArrayCopy = _RgbArray.slice();
        const rgbArrayWithoutAlpha = _RgbArray.length > 3 ? rgbArrayCopy.reverse().slice(1).reverse() : _RgbArray;
        let highest = { val: -1, index: -1 };
        let lowest = { val: Infinity, index: -1 };
        rgbArrayWithoutAlpha.map((val, index) => {
            if (val > highest.val) {
                highest = { val: val, index: index };
            }
            if (val < lowest.val) {
                lowest = { val: val, index: index };
            }
        });
        if (lowest.index === highest.index) {
            lowest.index = highest.index + 1;
        }
        const middleIndex = 3 - highest.index - lowest.index;
        const middle = {
            val: rgbArrayWithoutAlpha[middleIndex],
            index: middleIndex
        };
        return [lowest, middle, highest];
    }
    contrast(_Luminance) {
        const brightest = Math.max(1.05, _Luminance + 0.05);
        const darkest = Math.min(1.05, _Luminance + 0.05);
        const contrast = brightest / darkest;
        return contrast < 2.7;
    }
    isColor(_StrColor) {
        const CSSDeclaration = new Option().style;
        CSSDeclaration.color = _StrColor;
        return CSSDeclaration.color ? CSSDeclaration.color : null;
    }
    getRGBArray(_Rgb) {
        return _Rgb
            .replace(/^(rgb|rgba)\(/, '')
            .replace(/\)$/, '')
            .replace(/\s/g, '')
            .split(',')
            .map(x => +x);
    }
    luminance(_Rgb) {
        const rgbIntArray = this.getRGBArray(_Rgb);
        const W3algorithm = rgbIntArray.map(item => {
            item /= 255;
            return item <= 0.03928 ? item / 12.92 : Math.pow((item + 0.055) / 1.055, 2.4);
        });
        return W3algorithm[0] * 0.2126 + W3algorithm[1] * 0.7152 + W3algorithm[2] * 0.0722;
    }
    transparentize(_Rgb, _Percentage) {
        const baseArray = this.Base.replace(/^(rgb|rgba)\(/, '')
            .replace(/\)$/, '')
            .replace(/\s/g, '')
            .split(',')
            .map(x => +x);
        if (baseArray.length > 3) {
            baseArray.pop();
        }
        const amount = (100 - _Percentage) / 100;
        baseArray.push(amount);
        return `rgb(${baseArray.join()})`;
    }
}
export class DataControl {
    copyValuesFrom(_Data, _DestinationObject) {
        if (typeof _Data !== 'object') {
            return _DestinationObject;
        }
        const dataKeys = Object.keys(_Data);
        const destinationObjectKeys = Object.keys(_DestinationObject);
        dataKeys.forEach(key => {
            if (destinationObjectKeys.find(tKey => tKey === key || tKey === '_' + key)) {
                if (key.includes('Date')) {
                    const date = Date.parse(_Data[key]);
                    if (date) {
                        _DestinationObject[key] = new Date(date);
                    }
                    else {
                        if (_Data[key] !== null) {
                            _DestinationObject[key] = _Data[key];
                        }
                    }
                }
                else {
                    if (_Data[key] !== null) {
                        _DestinationObject[key] = _Data[key];
                    }
                }
            }
        });
        return _DestinationObject;
    }
}
export class Timer {
    constructor() {
        this.TimePassed = 0;
        this.Progress = 0;
        this.Remaining = 100;
    }
    setMilliseconds(_Milliseconds) {
        this.Milliseconds = _Milliseconds;
    }
    reset() {
        this.TimePassed = 0;
        this.Progress = 0;
    }
    pause() {
        this.TimePassed = 0;
        this.Progress = 0;
    }
    stop() {
        this.TimePassed = 0;
        clearInterval(this.Timer);
    }
    start() {
        this.Timer = setInterval(() => {
            if (this.TimePassed >= this.Milliseconds) {
                clearInterval(this.Timer);
                return;
            }
            this.TimePassed += 100;
            this.Progress = (this.TimePassed * 100) / this.Milliseconds;
            this.Remaining = 100 - this.Progress;
        }, 100);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2xvYmFsLWNsYXNzZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9uZ3gtYXdlc29tZS1wb3B1cC9jb3JlL2dsb2JhbC1jbGFzc2VzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUc5QyxNQUFNLE9BQU8sS0FBSztJQUFsQjtRQUNFLFVBQUssR0FBVyxJQUFJLENBQUM7UUFDckIsYUFBUSxHQUFXLElBQUksQ0FBQztRQUN4QixhQUFRLEdBQVcsSUFBSSxDQUFDO1FBQ3hCLFdBQU0sR0FBVyxJQUFJLENBQUM7UUFDdEIsY0FBUyxHQUFXLElBQUksQ0FBQztRQUN6QixjQUFTLEdBQVcsSUFBSSxDQUFDO1FBQ3pCLGVBQVUsR0FBWSxJQUFJLENBQUM7SUFDN0IsQ0FBQztDQUFBO0FBRUQsTUFBTSxPQUFPLFFBQVE7SUFBckI7UUFDRSxVQUFLLEdBQVcsSUFBSSxDQUFDO1FBQ3JCLFlBQU8sR0FBVyxJQUFJLENBQUM7SUFDekIsQ0FBQztDQUFBO0FBRUQsTUFBTSxPQUFPLFdBQVc7SUFFdEIsWUFDUyxLQUFhLEVBQ2IsRUFBVSxFQUNWLGFBQWtDLG1CQUFtQixDQUFDLE9BQU8sRUFDN0QsV0FBb0IsS0FBSztRQUh6QixVQUFLLEdBQUwsS0FBSyxDQUFRO1FBQ2IsT0FBRSxHQUFGLEVBQUUsQ0FBUTtRQUNWLGVBQVUsR0FBVixVQUFVLENBQW1EO1FBQzdELGFBQVEsR0FBUixRQUFRLENBQWlCO1FBTGxDLFdBQU0sR0FBRyxLQUFLLENBQUM7SUFNWixDQUFDO0lBRUosT0FBTztRQUNMLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO0lBQ3ZCLENBQUM7SUFDRCxNQUFNO1FBQ0osSUFBSSxDQUFDLFFBQVEsR0FBRyxLQUFLLENBQUM7SUFDeEIsQ0FBQztJQUNELElBQUk7UUFDRixJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztJQUNyQixD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QUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ25FLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLFFBQVEsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUN2RCxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxRQUFRLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDL0QsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQztZQUM5RCxNQUFNLE1BQU0sR0FBRyxTQUFTLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7WUFDMUYsTUFBTSxRQUFRLEdBQUcsU0FBUyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDNUcsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxRQUFRLEVBQUUsTUFBTSxDQUFDLEVBQUUsVUFBVSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBQ3ZHLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJ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O1FBQ3ZDLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztJQUNWLENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJ1dHRvbkxheW91dERpc3BsYXkgfSBmcm9tICcuL2VudW1zJztcbmltcG9ydCB7IElCdXR0b24sIElDb2xvck9iamVjdCwgSUNvbG9yVHlwZXMsIElHbG9iYWxDb25maWcsIElHbG9iYWxVc2VyQ29uZmlnLCBJU2l6ZXMgfSBmcm9tICcuL2dsb2JhbC1pbnRlcmZhY2VzJztcblxuZXhwb3J0IGNsYXNzIFNpemVzIGltcGxlbWVudHMgSVNpemVzIHtcbiAgd2lkdGg6IHN0cmluZyA9IG51bGw7XG4gIG1pbldpZHRoOiBzdHJpbmcgPSBudWxsO1xuICBtYXhXaWR0aDogc3RyaW5nID0gbnVsbDtcbiAgaGVpZ2h0OiBzdHJpbmcgPSBudWxsO1xuICBtaW5IZWlnaHQ6IHN0cmluZyA9IG51bGw7XG4gIG1heEhlaWdodDogc3RyaW5nID0gbnVsbDtcbiAgZnVsbFNjcmVlbjogYm9vbGVhbiA9IG51bGw7XG59XG5cbmV4cG9ydCBjbGFzcyBkaXNwYXRjaCB7XG4gIHRpdGxlOiBzdHJpbmcgPSBudWxsO1xuICBtZXNzYWdlOiBzdHJpbmcgPSBudWxsO1xufVxuXG5leHBvcnQgY2xhc3MgQnV0dG9uTWFrZXIgaW1wbGVtZW50cyBJQnV0dG9uIHtcbiAgaGlkZGVuID0gZmFsc2U7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyBsYWJlbDogc3RyaW5nLFxuICAgIHB1YmxpYyBJRDogc3RyaW5nLFxuICAgIHB1YmxpYyBsYXlvdXRUeXBlOiBCdXR0b25MYXlvdXREaXNwbGF5ID0gQnV0dG9uTGF5b3V0RGlzcGxheS5QUklNQVJZLFxuICAgIHB1YmxpYyBkaXNhYmxlZDogYm9vbGVhbiA9IGZhbHNlXG4gICkge31cblxuICBkaXNhYmxlKCk6IHZvaWQge1xuICAgIHRoaXMuZGlzYWJsZWQgPSB0cnVlO1xuICB9XG4gIGVuYWJsZSgpOiB2b2lkIHtcbiAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cbiAgaGlkZSgpOiB2b2lkIHtcbiAgICB0aGlzLmhpZGRlbiA9IHRydWU7XG4gIH1cbiAgc2hvdygpOiB2b2lkIHtcbiAgICB0aGlzLmhpZGRlbiA9IGZhbHNlO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBHbG9iYWxVc2VyQ29uZmlnIGltcGxlbWVudHMgSUdsb2JhbFVzZXJDb25maWcge1xuICBjb2xvckxpc3Q6IElDb2xvclR5cGVzID0gbmV3IENvbG9yVHlwZXMoKTtcblxuICBjb25zdHJ1Y3RvcihfR2xvYmFsVXNlckNvbmZpZzogSUdsb2JhbFVzZXJDb25maWcpIHtcbiAgICBpZiAoX0dsb2JhbFVzZXJDb25maWcpIHtcbiAgICAgIGNvbnN0IGRhdGFDb250cm9sID0gbmV3IERhdGFDb250cm9sKCk7XG4gICAgICBkYXRhQ29udHJvbC5jb3B5VmFsdWVzRnJvbShfR2xvYmFsVXNlckNvbmZpZywgdGhpcyk7XG4gICAgICBjb25zdCBjb2xvckxpc3QgPSBuZXcgQ29sb3JUeXBlcygpO1xuICAgICAgdGhpcy5jb2xvckxpc3QgPSBkYXRhQ29udHJvbC5jb3B5VmFsdWVzRnJvbSh0aGlzLmNvbG9yTGlzdCwgY29sb3JMaXN0KTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIENvbG9yVHlwZXMgaW1wbGVtZW50cyBJQ29sb3JUeXBlcyB7XG4gIHByaW1hcnk6IHN0cmluZyA9IG51bGw7XG4gIHNlY29uZGFyeTogc3RyaW5nID0gbnVsbDtcbiAgc3VjY2Vzczogc3RyaW5nID0gbnVsbDtcbiAgaW5mbzogc3RyaW5nID0gbnVsbDtcbiAgd2FybmluZzogc3RyaW5nID0gbnVsbDtcbiAgZGFuZ2VyOiBzdHJpbmcgPSBudWxsO1xuICBsaWdodDogc3RyaW5nID0gbnVsbDtcbiAgZGFyazogc3RyaW5nID0gbnVsbDtcbiAgY3VzdG9tT25lOiBzdHJpbmcgPSBudWxsO1xuICBjdXN0b21Ud286IHN0cmluZyA9IG51bGw7XG4gIGN1c3RvbVRocmVlOiBzdHJpbmcgPSBudWxsO1xuICBjdXN0b21Gb3VyOiBzdHJpbmcgPSBudWxsO1xuICBjdXN0b21GaXZlOiBzdHJpbmcgPSBudWxsO1xufVxuXG5leHBvcnQgY2xhc3MgR2xvYmFsQ29uZmlnIGltcGxlbWVudHMgSUdsb2JhbENvbmZpZyB7XG4gIGRpc3BsYXlDb2xvcjogSUNvbG9yT2JqZWN0ID0gbmV3IERpc3BsYXlDb2xvcigpO1xufVxuXG5leHBvcnQgY2xhc3MgRGlzcGxheUNvbG9yIGltcGxlbWVudHMgSUNvbG9yT2JqZWN0IHtcbiAgcHJpbWFyeTogQ29sb3JQcm92aWRlciA9IG51bGw7XG4gIHNlY29uZGFyeTogQ29sb3JQcm92aWRlciA9IG51bGw7XG4gIHN1Y2Nlc3M6IENvbG9yUHJvdmlkZXIgPSBudWxsO1xuICBpbmZvOiBDb2xvclByb3ZpZGVyID0gbnVsbDtcbiAgd2FybmluZzogQ29sb3JQcm92aWRlciA9IG51bGw7XG4gIGRhbmdlcjogQ29sb3JQcm92aWRlciA9IG51bGw7XG4gIGxpZ2h0OiBDb2xvclByb3ZpZGVyID0gbnVsbDtcbiAgZGFyazogQ29sb3JQcm92aWRlciA9IG51bGw7XG4gIGN1c3RvbU9uZTogQ29sb3JQcm92aWRlciA9IG51bGw7XG4gIGN1c3RvbVR3bzogQ29sb3JQcm92aWRlciA9IG51bGw7XG4gIGN1c3RvbVRocmVlOiBDb2xvclByb3ZpZGVyID0gbnVsbDtcbiAgY3VzdG9tRm91cjogQ29sb3JQcm92aWRlciA9IG51bGw7XG4gIGN1c3RvbUZpdmU6IENvbG9yUHJvdmlkZXIgPSBudWxsO1xufVxuXG5leHBvcnQgY2xhc3MgQ29sb3JQcm92aWRlciB7XG4gIEJhc2U6IHN0cmluZyA9IG51bGw7XG4gIEJyaWdodGVuOiBzdHJpbmcgPSBudWxsO1xuICBCcmlnaHRlbkZvclNoYWRlOiBzdHJpbmcgPSBudWxsO1xuICBEYXJrZW46IHN0cmluZyA9IG51bGw7XG4gIERhcmtlbkZvclNoYWRlOiBzdHJpbmcgPSBudWxsO1xuICBDb250cmFzdENvbG9yOiBzdHJpbmcgPSBudWxsO1xuICBUcmFuc3BhcmVudERhcmtlblZhcmlhbmNlOiBzdHJpbmcgPSBudWxsO1xuICBCcmlnaHRTaGFkZTogc3RyaW5nID0gbnVsbDtcbiAgQnJpZ2h0V2FybWx5OiBzdHJpbmcgPSBudWxsO1xuICBJc0Jhc2VCcmlnaHQ6IGJvb2xlYW4gPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKF9Db2xvcjogc3RyaW5nKSB7XG4gICAgaWYgKCh0aGlzLkJhc2UgPSB0aGlzLmlzQ29sb3IoX0NvbG9yKSkpIHtcbiAgICAgIHRoaXMuQnJpZ2h0ZW4gPSB0aGlzLmJyaWdodG5lc3ModGhpcy5CYXNlLCAnYnJpZ2h0ZW4nLCAyNSk7XG4gICAgICB0aGlzLkJyaWdodGVuRm9yU2hhZGUgPSB0aGlzLmJyaWdodG5lc3ModGhpcy5CYXNlLCAnYnJpZ2h0ZW4nLCAxMCk7XG4gICAgICB0aGlzLkRhcmtlbiA9IHRoaXMuYnJpZ2h0bmVzcyh0aGlzLkJhc2UsICdkYXJrZW4nLCAyMCk7XG4gICAgICB0aGlzLkRhcmtlbkZvclNoYWRlID0gdGhpcy5icmlnaHRuZXNzKHRoaXMuQmFzZSwgJ2RhcmtlbicsIDEwKTtcbiAgICAgIGNvbnN0IGx1bWluYW5jZSA9IE1hdGguZmxvb3IodGhpcy5sdW1pbmFuY2UodGhpcy5CYXNlKSAqIDEwMCk7XG4gICAgICBjb25zdCBkYXJrZW4gPSBsdW1pbmFuY2UgPiA1MCA/IDUgOiBsdW1pbmFuY2UgPiA0MCA/IDEwIDogbHVtaW5hbmNlID4gMjAgPyAxNSA6IGx1bWluYW5jZTtcbiAgICAgIGNvbnN0IGJyaWdodGVuID0gbHVtaW5hbmNlID4gNTUgPyA2NSA6IGx1bWluYW5jZSA+IDQ1ID8gNjAgOiBsdW1pbmFuY2UgPiAyMCA/IDU1IDogbHVtaW5hbmNlID4gMTAgPyA0NSA6IDgwO1xuICAgICAgdGhpcy5CcmlnaHRTaGFkZSA9IHRoaXMuYnJpZ2h0bmVzcyh0aGlzLmJyaWdodG5lc3ModGhpcy5CYXNlLCAnZGFya2VuJywgZGFya2VuKSwgJ2JyaWdodGVuJywgYnJpZ2h0ZW4pO1xuICAgICAgdGhpcy5CcmlnaHRXYXJtbHkgPSB0aGlzLmJyaWdodG5lc3ModGhpcy5icmlnaHRuZXNzKHRoaXMuc2F0dXJhdGUodGhpcy5CYXNlKSwgJ2RhcmtlbicsIGRhcmtlbiAtIDEwKSwgJ2JyaWdodGVuJywgYnJpZ2h0ZW4gLSA1KTtcbiAgICAgIHRoaXMuVHJhbnNwYXJlbnREYXJrZW5WYXJpYW5jZSA9IHRoaXMuYnJpZ2h0bmVzcyh0aGlzLnRyYW5zcGFyZW50aXplKHRoaXMuQmFzZSwgODApLCAnZGFya2VuJywgNDApO1xuICAgICAgaWYgKHRoaXMuaXNCcmlnaHQodGhpcy5CYXNlKSkge1xuICAgICAgICB0aGlzLkNvbnRyYXN0Q29sb3IgPSAncmdiYSg1OCw2NSw3MSwwLjUpJztcbiAgICAgICAgdGhpcy5Jc0Jhc2VCcmlnaHQgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5Db250cmFzdENvbG9yID0gJ3JnYigyNTUsMjU1LDI1NSwgMC43KSc7XG4gICAgICAgIHRoaXMuSXNCYXNlQnJpZ2h0ID0gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIC8qXHQgICAgICAgY29uc29sZS5sb2coJyVjIEJyaWdodFNoYWRlICcsIGBiYWNrZ3JvdW5kOiAke3RoaXMuQnJpZ2h0U2hhZGV9OyBjb2xvcjogJHt0aGlzLkNvbnRyYXN0Q29sb3J9YCwgdGhpcy5CcmlnaHRTaGFkZSk7XG5cdFx0XHRcdFx0ICAgICAgIGNvbnNvbGUubG9nKCclYyBCcmlnaHRXYXJtbHkgJywgYGJhY2tncm91bmQ6ICR7dGhpcy5CcmlnaHRXYXJtbHl9OyBjb2xvcjogJHt0aGlzLkNvbnRyYXN0Q29sb3J9YCwgdGhpcy5CcmlnaHRXYXJtbHkpO1xuXHRcdFx0XHRcdFx0ICAgICBjb25zb2xlLmxvZygnJWMgQnJpZ2h0ZW4gJywgYGJhY2tncm91bmQ6ICR7dGhpcy5CcmlnaHRlbn07IGNvbG9yOiAke3RoaXMuQ29udHJhc3RDb2xvcn1gLCB0aGlzLkJyaWdodGVuKTtcblx0XHRcdFx0XHRcdCAgICAgY29uc29sZS5sb2coJyVjIEJyaWdodGVuRm9yU2hhZGUgJywgYGJhY2tncm91bmQ6ICR7dGhpcy5CcmlnaHRlbkZvclNoYWRlfTsgY29sb3I6ICR7dGhpcy5Db250cmFzdENvbG9yfWAsIHRoaXMuQnJpZ2h0ZW5Gb3JTaGFkZSk7XG5cdFx0XHRcdFx0ICAgICAgIGNvbnNvbGUubG9nKCclYyBCYXNlICcsIGBiYWNrZ3JvdW5kOiAke3RoaXMuQmFzZX07IGNvbG9yOiAke3RoaXMuQ29udHJhc3RDb2xvcn1gLCB0aGlzLkJhc2UpO1xuXHRcdFx0XHRcdCAgICAgICBjb25zb2xlLmxvZygnJWMgRGFya2VuRm9yU2hhZGUgJywgYGJhY2tncm91bmQ6ICR7dGhpcy5EYXJrZW5Gb3JTaGFkZX07IGNvbG9yOiAke3RoaXMuQ29udHJhc3RDb2xvcn1gLCB0aGlzLkRhcmtlbkZvclNoYWRlKTtcblx0XHRcdFx0XHQgICAgICAgY29uc29sZS5sb2coJyVjIERhcmtlbiAnLCBgYmFja2dyb3VuZDogJHt0aGlzLkRhcmtlbn07IGNvbG9yOiAke3RoaXMuQ29udHJhc3RDb2xvcn1gLCB0aGlzLkRhcmtlbik7XG5cdFx0XHRcdFx0XHQgICAgIGNvbnNvbGUubG9nKCclYyBUcmFuc3BhcmVudERhcmtlblZhcmlhbmNlICcsIGBiYWNrZ3JvdW5kOiAke3RoaXMuVHJhbnNwYXJlbnREYXJrZW5WYXJpYW5jZX07IGNvbG9yOiAke3RoaXMuQ29udHJhc3RDb2xvcn1gLCB0aGlzLlRyYW5zcGFyZW50RGFya2VuVmFyaWFuY2UpO1xuXHRcdFx0Ki9cbiAgICB9XG4gIH1cblxuICBzYXR1cmF0ZShfUmdiOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IHJnYkludEFycmF5ID0gdGhpcy5nZXRSR0JBcnJheShfUmdiKTtcbiAgICBjb25zdCBncmV5VmFsID0gdGhpcy5nZXRMaWdodG5lc3NPZlJHQihfUmdiKSAqIDU1O1xuICAgIGNvbnN0IFtsb3dlc3QsIG1pZGRsZSwgaGlnaGVzdF0gPSB0aGlzLmdldExvd01pZEhpKHJnYkludEFycmF5KTtcblxuICAgIGlmIChsb3dlc3QudmFsID09PSBoaWdoZXN0LnZhbCkge1xuICAgICAgcmV0dXJuIF9SZ2I7XG4gICAgfVxuXG4gICAgY29uc3Qgc2F0dXJhdGlvblJhbmdlID0gTWF0aC5yb3VuZChNYXRoLm1pbigyNTUgLSBncmV5VmFsLCBncmV5VmFsKSk7XG4gICAgY29uc3QgbWF4Q2hhbmdlID0gTWF0aC5taW4oMjU1IC0gaGlnaGVzdC52YWwsIGxvd2VzdC52YWwpO1xuICAgIGNvbnN0IGNoYW5nZUFtb3VudCA9IE1hdGgubWluKHNhdHVyYXRpb25SYW5nZSAvIDEwLCBtYXhDaGFuZ2UpO1xuICAgIGNvbnN0IG1pZGRsZVZhbHVlUmF0aW8gPSAoZ3JleVZhbCAtIG1pZGRsZS52YWwpIC8gKGdyZXlWYWwgLSBoaWdoZXN0LnZhbCkgKyAwLjA3O1xuXG4gICAgY29uc3QgcmV0dXJuQXJyYXkgPSBbXTtcbiAgICByZXR1cm5BcnJheVtoaWdoZXN0LmluZGV4XSA9IE1hdGgucm91bmQoaGlnaGVzdC52YWwgKyBjaGFuZ2VBbW91bnQpO1xuICAgIHJldHVybkFycmF5W2xvd2VzdC5pbmRleF0gPSBNYXRoLnJvdW5kKGxvd2VzdC52YWwgLSBjaGFuZ2VBbW91bnQpO1xuICAgIHJldHVybkFycmF5W21pZGRsZS5pbmRleF0gPSBNYXRoLnJvdW5kKGdyZXlWYWwgKyAocmV0dXJuQXJyYXlbaGlnaGVzdC5pbmRleF0gLSBncmV5VmFsKSAqIG1pZGRsZVZhbHVlUmF0aW8gKyA1KTtcbiAgICByZXR1cm4gYHJnYigke1tyZXR1cm5BcnJheV0uam9pbigpfSlgO1xuICB9XG5cbiAgcHVibGljIGJyaWdodG5lc3MoX1JnYjogc3RyaW5nLCBfQWN0aW9uOiAnYnJpZ2h0ZW4nIHwgJ2RhcmtlbicsIF9QZXJjZW50YWdlOiBudW1iZXIpOiBzdHJpbmcge1xuICAgIGNvbnN0IHJnYkludEFycmF5ID0gdGhpcy5nZXRSR0JBcnJheShfUmdiKTtcbiAgICBjb25zdCBbbG93ZXN0LCBtaWRkbGUsIGhpZ2hlc3RdID0gdGhpcy5nZXRMb3dNaWRIaShyZ2JJbnRBcnJheSk7XG5cbiAgICBpZiAoX0FjdGlvbiA9PT0gJ2JyaWdodGVuJyAmJiBsb3dlc3QudmFsID09PSAyNTUpIHtcbiAgICAgIHJldHVybiBfUmdiO1xuICAgIH1cblxuICAgIGlmIChfQWN0aW9uID09PSAnZGFya2VuJyAmJiBoaWdoZXN0LnZhbCA9PT0gMCkge1xuICAgICAgcmV0dXJuIF9SZ2I7XG4gICAgfVxuXG4gICAgY29uc3QgYW1vdW50ID0gKF9QZXJjZW50YWdlIC8gMTAwKSAqIDI1NTtcblxuICAgIGxldCByZXR1cm5MaXN0ID0gW107XG5cbiAgICBpZiAoX0FjdGlvbiA9PT0gJ2JyaWdodGVuJykge1xuICAgICAgcmV0dXJuTGlzdFtsb3dlc3QuaW5kZXhdID0gTWF0aC5yb3VuZChsb3dlc3QudmFsICsgTWF0aC5taW4oMjU1IC0gbG93ZXN0LnZhbCwgYW1vdW50KSk7XG4gICAgICBjb25zdCBpbmNyZWFzZUZyYWN0aW9uID0gKHJldHVybkxpc3RbbG93ZXN0LmluZGV4XSAtIGxvd2VzdC52YWwpIC8gKDI1NSAtIGxvd2VzdC52YWwpO1xuICAgICAgcmV0dXJuTGlzdFttaWRkbGUuaW5kZXhdID0gbWlkZGxlLnZhbCArICgyNTUgLSBtaWRkbGUudmFsKSAqIGluY3JlYXNlRnJhY3Rpb247XG4gICAgICByZXR1cm5MaXN0W2hpZ2hlc3QuaW5kZXhdID0gaGlnaGVzdC52YWwgKyAoMjU1IC0gaGlnaGVzdC52YWwpICogaW5jcmVhc2VGcmFjdGlvbjtcbiAgICB9XG4gICAgaWYgKF9BY3Rpb24gPT09ICdkYXJrZW4nKSB7XG4gICAgICByZXR1cm5MaXN0W2hpZ2hlc3QuaW5kZXhdID0gaGlnaGVzdC52YWwgLSBNYXRoLm1pbihoaWdoZXN0LnZhbCwgYW1vdW50KTtcbiAgICAgIGNvbnN0IGRlY3JlYXNlRnJhY3Rpb24gPSAoaGlnaGVzdC52YWwgLSByZXR1cm5MaXN0W2hpZ2hlc3QuaW5kZXhdKSAvIGhpZ2hlc3QudmFsO1xuICAgICAgcmV0dXJuTGlzdFttaWRkbGUuaW5kZXhdID0gbWlkZGxlLnZhbCAtIG1pZGRsZS52YWwgKiBkZWNyZWFzZUZyYWN0aW9uO1xuICAgICAgcmV0dXJuTGlzdFtsb3dlc3QuaW5kZXhdID0gbG93ZXN0LnZhbCAtIGxvd2VzdC52YWwgKiBkZWNyZWFzZUZyYWN0aW9uO1xuICAgIH1cblxuICAgIHJldHVybkxpc3QgPSByZXR1cm5MaXN0Lm1hcChpdGVtID0+IE1hdGgucm91bmQoaXRlbSkpO1xuICAgIGlmIChyZ2JJbnRBcnJheS5sZW5ndGggPiAzKSB7XG4gICAgICByZXR1cm5MaXN0LnB1c2gocmdiSW50QXJyYXlbM10pO1xuICAgICAgcmV0dXJuIGByZ2JhKCR7cmV0dXJuTGlzdC5qb2luKCl9KWA7XG4gICAgfVxuICAgIHJldHVybiBgcmdiKCR7cmV0dXJuTGlzdC5qb2luKCl9KWA7XG4gIH1cblxuICBnZXRMaWdodG5lc3NPZlJHQihfUmdiOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIGNvbnN0IHJnYkludEFycmF5ID0gdGhpcy5nZXRSR0JBcnJheShfUmdiKTtcblxuICAgIGNvbnN0IGhpZ2hlc3QgPSBNYXRoLm1heCguLi5yZ2JJbnRBcnJheSk7XG4gICAgY29uc3QgbG93ZXN0ID0gTWF0aC5taW4oLi4ucmdiSW50QXJyYXkpO1xuICAgIHJldHVybiAoaGlnaGVzdCArIGxvd2VzdCkgLyAyIC8gMjU1O1xuICB9XG5cbiAgcHJpdmF0ZSBpc0JyaWdodChfUmdiOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5jb250cmFzdCh0aGlzLmx1bWluYW5jZShfUmdiKSk7XG4gIH1cblxuICAvL1xuICBwcml2YXRlIGdldExvd01pZEhpKF9SZ2JBcnJheTogbnVtYmVyW10pOiB7IGluZGV4OiBudW1iZXI7IHZhbDogbnVtYmVyIH1bXSB7XG4gICAgY29uc3QgcmdiQXJyYXlDb3B5ID0gX1JnYkFycmF5LnNsaWNlKCk7XG4gICAgY29uc3QgcmdiQXJyYXlXaXRob3V0QWxwaGEgPSBfUmdiQXJyYXkubGVuZ3RoID4gMyA/IHJnYkFycmF5Q29weS5yZXZlcnNlKCkuc2xpY2UoMSkucmV2ZXJzZSgpIDogX1JnYkFycmF5O1xuICAgIGxldCBoaWdoZXN0ID0geyB2YWw6IC0xLCBpbmRleDogLTEgfTtcbiAgICBsZXQgbG93ZXN0ID0geyB2YWw6IEluZmluaXR5LCBpbmRleDogLTEgfTtcblxuICAgIHJnYkFycmF5V2l0aG91dEFscGhhLm1hcCgodmFsLCBpbmRleCkgPT4ge1xuICAgICAgaWYgKHZhbCA+IGhpZ2hlc3QudmFsKSB7XG4gICAgICAgIGhpZ2hlc3QgPSB7IHZhbDogdmFsLCBpbmRleDogaW5kZXggfTtcbiAgICAgIH1cbiAgICAgIGlmICh2YWwgPCBsb3dlc3QudmFsKSB7XG4gICAgICAgIGxvd2VzdCA9IHsgdmFsOiB2YWwsIGluZGV4OiBpbmRleCB9O1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKGxvd2VzdC5pbmRleCA9PT0gaGlnaGVzdC5pbmRleCkge1xuICAgICAgbG93ZXN0LmluZGV4ID0gaGlnaGVzdC5pbmRleCArIDE7XG4gICAgfVxuXG4gICAgY29uc3QgbWlkZGxlSW5kZXggPSAzIC0gaGlnaGVzdC5pbmRleCAtIGxvd2VzdC5pbmRleDtcbiAgICBjb25zdCBtaWRkbGUgPSB7XG4gICAgICB2YWw6IHJnYkFycmF5V2l0aG91dEFscGhhW21pZGRsZUluZGV4XSxcbiAgICAgIGluZGV4OiBtaWRkbGVJbmRleFxuICAgIH07XG4gICAgcmV0dXJuIFtsb3dlc3QsIG1pZGRsZSwgaGlnaGVzdF07XG4gIH1cblxuICBwcml2YXRlIGNvbnRyYXN0KF9MdW1pbmFuY2UpOiBib29sZWFuIHtcbiAgICBjb25zdCBicmlnaHRlc3QgPSBNYXRoLm1heCgxLjA1LCBfTHVtaW5hbmNlICsgMC4wNSk7XG4gICAgY29uc3QgZGFya2VzdCA9IE1hdGgubWluKDEuMDUsIF9MdW1pbmFuY2UgKyAwLjA1KTtcbiAgICBjb25zdCBjb250cmFzdCA9IGJyaWdodGVzdCAvIGRhcmtlc3Q7XG4gICAgcmV0dXJuIGNvbnRyYXN0IDwgMi43O1xuICB9XG5cbiAgcHJpdmF0ZSBpc0NvbG9yKF9TdHJDb2xvcik6IHN0cmluZyB7XG4gICAgY29uc3QgQ1NTRGVjbGFyYXRpb24gPSBuZXcgT3B0aW9uKCkuc3R5bGU7XG4gICAgQ1NTRGVjbGFyYXRpb24uY29sb3IgPSBfU3RyQ29sb3I7XG4gICAgcmV0dXJuIENTU0RlY2xhcmF0aW9uLmNvbG9yID8gQ1NTRGVjbGFyYXRpb24uY29sb3IgOiBudWxsO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRSR0JBcnJheShfUmdiOiBzdHJpbmcpOiBudW1iZXJbXSB7XG4gICAgcmV0dXJuIF9SZ2JcbiAgICAgIC5yZXBsYWNlKC9eKHJnYnxyZ2JhKVxcKC8sICcnKVxuICAgICAgLnJlcGxhY2UoL1xcKSQvLCAnJylcbiAgICAgIC5yZXBsYWNlKC9cXHMvZywgJycpXG4gICAgICAuc3BsaXQoJywnKVxuICAgICAgLm1hcCh4ID0+ICt4KTtcbiAgfVxuXG4gIHByaXZhdGUgbHVtaW5hbmNlKF9SZ2I6IHN0cmluZyk6IG51bWJlciB7XG4gICAgY29uc3QgcmdiSW50QXJyYXkgPSB0aGlzLmdldFJHQkFycmF5KF9SZ2IpO1xuICAgIGNvbnN0IFczYWxnb3JpdGhtID0gcmdiSW50QXJyYXkubWFwKGl0ZW0gPT4ge1xuICAgICAgaXRlbSAvPSAyNTU7XG4gICAgICByZXR1cm4gaXRlbSA8PSAwLjAzOTI4ID8gaXRlbSAvIDEyLjkyIDogTWF0aC5wb3coKGl0ZW0gKyAwLjA1NSkgLyAxLjA1NSwgMi40KTtcbiAgICB9KTtcbiAgICByZXR1cm4gVzNhbGdvcml0aG1bMF0gKiAwLjIxMjYgKyBXM2FsZ29yaXRobVsxXSAqIDAuNzE1MiArIFczYWxnb3JpdGhtWzJdICogMC4wNzIyO1xuICB9XG5cbiAgcHJpdmF0ZSB0cmFuc3BhcmVudGl6ZShfUmdiOiBzdHJpbmcsIF9QZXJjZW50YWdlOiBudW1iZXIpOiBzdHJpbmcge1xuICAgIGNvbnN0IGJhc2VBcnJheSA9IHRoaXMuQmFzZS5yZXBsYWNlKC9eKHJnYnxyZ2JhKVxcKC8sICcnKVxuICAgICAgLnJlcGxhY2UoL1xcKSQvLCAnJylcbiAgICAgIC5yZXBsYWNlKC9cXHMvZywgJycpXG4gICAgICAuc3BsaXQoJywnKVxuICAgICAgLm1hcCh4ID0+ICt4KTtcbiAgICBpZiAoYmFzZUFycmF5Lmxlbmd0aCA+IDMpIHtcbiAgICAgIGJhc2VBcnJheS5wb3AoKTtcbiAgICB9XG4gICAgY29uc3QgYW1vdW50ID0gKDEwMCAtIF9QZXJjZW50YWdlKSAvIDEwMDtcbiAgICBiYXNlQXJyYXkucHVzaChhbW91bnQpO1xuICAgIHJldHVybiBgcmdiKCR7YmFzZUFycmF5LmpvaW4oKX0pYDtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgRGF0YUNvbnRyb2wge1xuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgcHVibGljIGNvcHlWYWx1ZXNGcm9tKF9EYXRhOiBhbnksIF9EZXN0aW5hdGlvbk9iamVjdDogYW55KTogYW55IHtcbiAgICBpZiAodHlwZW9mIF9EYXRhICE9PSAnb2JqZWN0Jykge1xuICAgICAgcmV0dXJuIF9EZXN0aW5hdGlvbk9iamVjdDtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhS2V5cyA9IE9iamVjdC5rZXlzKF9EYXRhKTtcbiAgICBjb25zdCBkZXN0aW5hdGlvbk9iamVjdEtleXMgPSBPYmplY3Qua2V5cyhfRGVzdGluYXRpb25PYmplY3QpO1xuXG4gICAgZGF0YUtleXMuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgaWYgKGRlc3RpbmF0aW9uT2JqZWN0S2V5cy5maW5kKHRLZXkgPT4gdEtleSA9PT0ga2V5IHx8IHRLZXkgPT09ICdfJyArIGtleSkpIHtcbiAgICAgICAgaWYgKGtleS5pbmNsdWRlcygnRGF0ZScpKSB7XG4gICAgICAgICAgY29uc3QgZGF0ZSA9IERhdGUucGFyc2UoX0RhdGFba2V5XSk7XG4gICAgICAgICAgaWYgKGRhdGUpIHtcbiAgICAgICAgICAgIF9EZXN0aW5hdGlvbk9iamVjdFtrZXldID0gbmV3IERhdGUoZGF0ZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChfRGF0YVtrZXldICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgIF9EZXN0aW5hdGlvbk9iamVjdFtrZXldID0gX0RhdGFba2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKF9EYXRhW2tleV0gIT09IG51bGwpIHtcbiAgICAgICAgICAgIF9EZXN0aW5hdGlvbk9iamVjdFtrZXldID0gX0RhdGFba2V5XTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBfRGVzdGluYXRpb25PYmplY3Q7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFRpbWVyIHtcbiAgVGltZVBhc3NlZCA9IDA7XG4gIFRpbWVyOiBhbnk7XG4gIFByb2dyZXNzID0gMDtcbiAgUmVtYWluaW5nID0gMTAwO1xuICBNaWxsaXNlY29uZHM6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcigpIHt9XG5cbiAgc2V0TWlsbGlzZWNvbmRzKF9NaWxsaXNlY29uZHM6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMuTWlsbGlzZWNvbmRzID0gX01pbGxpc2Vjb25kcztcbiAgfVxuXG4gIHJlc2V0KCk6IHZvaWQge1xuICAgIHRoaXMuVGltZVBhc3NlZCA9IDA7XG4gICAgdGhpcy5Qcm9ncmVzcyA9IDA7XG4gIH1cblxuICBwYXVzZSgpOiB2b2lkIHtcbiAgICB0aGlzLlRpbWVQYXNzZWQgPSAwO1xuICAgIHRoaXMuUHJvZ3Jlc3MgPSAwO1xuICB9XG5cbiAgc3RvcCgpOiB2b2lkIHtcbiAgICB0aGlzLlRpbWVQYXNzZWQgPSAwO1xuICAgIGNsZWFySW50ZXJ2YWwodGhpcy5UaW1lcik7XG4gIH1cblxuICBzdGFydCgpOiB2b2lkIHtcbiAgICB0aGlzLlRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuVGltZVBhc3NlZCA+PSB0aGlzLk1pbGxpc2Vjb25kcykge1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMuVGltZXIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLlRpbWVQYXNzZWQgKz0gMTAwO1xuICAgICAgdGhpcy5Qcm9ncmVzcyA9ICh0aGlzLlRpbWVQYXNzZWQgKiAxMDApIC8gdGhpcy5NaWxsaXNlY29uZHM7XG4gICAgICB0aGlzLlJlbWFpbmluZyA9IDEwMCAtIHRoaXMuUHJvZ3Jlc3M7XG4gICAgfSwgMTAwKTtcbiAgfVxufVxuIl19